<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="George Savva, (QIB)">

<title>Introduction to ‘R’ statistical software for statistical analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="day1_files/libs/clipboard/clipboard.min.js"></script>
<script src="day1_files/libs/quarto-html/quarto.js"></script>
<script src="day1_files/libs/quarto-html/popper.min.js"></script>
<script src="day1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="day1_files/libs/quarto-html/anchor.min.js"></script>
<link href="day1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="day1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="day1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="day1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="day1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to ‘R’ statistical software for statistical analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>George Savva, (QIB) </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<div class="cell">

</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>This course will introduce</p>
<ul>
<li>R and RStudio statistical software</li>
<li>examples of performing common tasks in scientific data analysis</li>
<li>where to go for further support</li>
</ul>
<p>The aim is to become familiar with the R/RStudio environment and some common functions and workflows. This will enable you to learn the specific functions that you need on your own or with further training.</p>
<p>All of the commands for the worked examples and the exercises is in the file TutorialScript.R. The commands for the worked examples are also typed out here.</p>
<p>Powerpoint slides for each day’s lectures are here:</p>
<ul>
<li><a href="./rStatsMar22.pptx">Day 1 slides</a></li>
<li><a href="./day2_tidydata.pptx">Day 2 slides</a></li>
</ul>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">Learning objectives</h2>
<p>We will focus on the tasks used in a typical analysis of a single scientific dataset, mirroring the tasks usually conducted in other statistical software.</p>
<section id="specific-tasks" class="level3">
<h3 class="anchored" data-anchor-id="specific-tasks">Specific tasks:</h3>
<p>Day 1: R and RStudio basics</p>
<ul>
<li>Basics of the R language</li>
<li>Making an Rstudio project</li>
<li>Loading packages</li>
<li>Loading a dataset into R from an Excel file</li>
<li>Exploring your data and calculating descriptive statistics</li>
<li>Simple hypothesis tests</li>
</ul>
<p>Day 2: (Self-directed learning) Loading data from Excel; revision of day 1 tasks</p>
<ul>
<li>Using the help system to learn the <code>readxl</code> package</li>
<li>Make plots, descriptive statistics and hypothesis tests</li>
</ul>
<p>Day 3: Real data!</p>
<ul>
<li>Revision of days 1 and 2</li>
<li>Merging datasets</li>
<li>Estimating and diagnosing linear models</li>
</ul>
</section>
<section id="how-to-use-r" class="level3">
<h3 class="anchored" data-anchor-id="how-to-use-r">How to use R</h3>
<ul>
<li>Using R and RStudio</li>
<li>RStudio ‘projects’ and a good workflow</li>
<li>The command line interface</li>
<li>Using scripts for reproducibility</li>
<li>Getting help</li>
<li>Using packages</li>
</ul>
</section>
<section id="how-r-works" class="level3">
<h3 class="anchored" data-anchor-id="how-r-works">How R works</h3>
<ul>
<li>Objects and functions</li>
<li>Data frames and vectors</li>
<li>Types of data: numerics, factors, and strings</li>
<li>Representing and handling ‘missing’ values</li>
<li>The importance of ‘tidy’ data</li>
</ul>
</section>
</section>
</section>
<section id="intro" class="level1">
<h1>Getting R and RStudio</h1>
<section id="what-are-r-and-rstudio" class="level2">
<h2 class="anchored" data-anchor-id="what-are-r-and-rstudio">What are R and RStudio?</h2>
<p>R is a free and open source statistics package, initially developed during the 1990s, and that has now become the world’s most widely used and comprehensive statistical software. R calls itself a ‘programming language <em>and</em> environment for statistic computing’.</p>
<p>That is, ‘R’ refers both to the software itself and the programming language that you use to interact with it.</p>
<p>RStudio is a free open source integrated development environment (IDE) for R that makes working R much easier. Most R users use RStudio and we recommend using RStudio for new users.</p>
<p>The great strength of R is in its contributed packages, these are community written add-ons that provide functions to help you perform almost any statistical, programming, or data-related task. We will introduce some commonly used packages for data management, analysis and graphing during this course.</p>
</section>
<section id="exercise-1.-getting-started" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1.-getting-started">Exercise 1. Getting started</h2>
<section id="getting-r-and-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="getting-r-and-rstudio">Getting R and RStudio</h3>
<p>If you are using a PC in the IT training suite it will already have an up-to-date version of R and RStudio. For other NBI managed devices you can install R and RStudio from the NBI software catalogue.</p>
<p>If you want to install R and RStudio on your own device:</p>
<ol type="1">
<li><p>Download and install the latest version of R from https://cran.r-project.org/</p></li>
<li><p>Then download and install RStudio from https://www.rstudio.com/</p></li>
</ol>
</section>
<section id="starting-rstudio" class="level3">
<h3 class="anchored" data-anchor-id="starting-rstudio">Starting RStudio</h3>
<p>Start RStudio. It will detect your installation of R, and you should see a screen like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="./rstudio.png" class="img-fluid figure-img"></p>
<p></p><figcaption class="figure-caption">Figure: RStudio Window</figcaption><p></p>
</figure>
</div>
<p>On the left is the console window, where you type commands and see output. The windows on the right hold various useful tabs, here the top pane is showing the data I happen to currently have loaded in my environment (yours will initially be empty) and a viewer showing part of my filesystem at the bottom. These right-hand windows can also show graphs, help files, and your command history.</p>
</section>
<section id="check-r-and-rstudio-are-working-run-your-first-command" class="level3">
<h3 class="anchored" data-anchor-id="check-r-and-rstudio-are-working-run-your-first-command">Check R and RStudio are working, run your first command</h3>
<ol start="4" type="1">
<li>Click in the console window and type:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Press return on your keyboard. You should see:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>This is the basic way in which R works. We enter commands at the command prompt, and we get the output in the console window.</p>
<ol start="5" type="1">
<li>Try a few other mathematical functions at the R console.</li>
</ol>
</section>
</section>
</section>
<section id="using-projects-and-scripts" class="level1">
<h1>Using projects and scripts</h1>
<p>Before we go any further, we are going to start an RStudio ‘project’ to organise our work during this course. Using projects helps us to keep all of the data and analysis for a particular piece of work in the same place.</p>
<p>Click on ‘New → New project’ in the main toolbar. Click ‘Start a new project in a brand new working directory’. Then click ‘new project’ on the next screen.</p>
<p>Now you can choose where to create the new directory for your R project, and what to call it. Make a project called ‘Rtraining’ or something like that, somewhere in your personal filestore.</p>
<p>Now, when you return to the main RStudio window you are working within your project. Notice that the ‘working directory’ has automatically switched to the new directory that you created, and the ‘files’ tab on the bottom left of the window is now showing the root of the project directory you created.</p>
<section id="making-a-script" class="level2">
<h2 class="anchored" data-anchor-id="making-a-script">Making a script</h2>
<p>We could do everything by typing commands into the console window as we have already seen, but this is not good if we want to remember or repeat something we have done, or share it with others.</p>
<p>So instead we will type our commands into files called R scripts and run the commands from there. With a script you can run and re-run bigger analyses that chain together all the functions you need for data loading, cleaning, analysing, reporting etc.</p>
<p>Using scripts mean we can develop complex analyses, and that when we come back to them later, eg if something changes in our data that means we need to redo everything, or we want to tweak something in our analysis because of a reviewer’s comment, we can easily do this without having to remember or reconstruct what we did.</p>
<p>It is good to keep a separate R script for each analysis that you do, such that each starts with the functions to load the required data, do any cleaning or coding that is necessary, then to perform and report the data analysis.</p>
<p>I have made an example of such a script, annotated with comments, in the files that accompany this handout.</p>
</section>
<section id="worked-example-1.-make-a-script" class="level2">
<h2 class="anchored" data-anchor-id="worked-example-1.-make-a-script">Worked Example 1. Make a script</h2>
<ol type="1">
<li><p>Make a new script. Click on File → New File → R Script in the main RStudio window. An empty file will appear in the top-left pane.</p></li>
<li><p>Save your script with a sensible filename (even though it is empty). Having unsaved scripts is a bad idea, RStudio is sometimes unstable and while it will try to recover unsaved work it is not always guaranteed to. Get into the habit of saving your scripts regularly.</p></li>
<li><p>Put some of the mathematical functions that you have already tried into your script, with one on each line.</p></li>
</ol>
<p>You can now run code from scripts in several ways.</p>
<ol type="1">
<li>If you press ‘run’ or type Ctrl+Enter on the keyboard, RStudio will send the line that the cursor is on to the R console and will run it. (Rstudio will try to identify if that line is a part of a multiline command - which may or may not work).</li>
<li>If you highlight an area of the script and then hit ‘run’ (or press Ctrl+Enter) then RStudio will send all the highlighted code to the R console.</li>
<li>If you save the file, then press ‘source’, R will load the file from disk and run all the commands from that file in sequence. Doing this you won’t see any output unless you specifically ask for it (or press ‘source with echo’).</li>
</ol>
<p>There are some subtle differences between what happens with run and source, but in general you can use either. I typically use ‘run’ while developing scripts and ‘source’ when they are finished to get the final answers.</p>
<p>If you have your raw data saved, and you keep your scripts, then you don’t need to save your results or any of the variables that you generated or modified during your analysis. So long as the orginal data doesn’t change, running the script will reproduce all of your analysis and output. This is a better way of working than trying to save your environment with all of your results and tables in.</p>
<p>I have created a script including all the analyses from this tutorial, in TutorialScript.R. Load this and have a look around. Notice my comments to remind myself why I did things, this might be helpful when I next come to revise the analysis!</p>
<p><strong>Important:</strong> Keep the R scripts and the data associated with this training course in the project directory, so that you can access them easily.</p>
<p>See:</p>
<ul>
<li>https://r4ds.had.co.nz/workflow-projects.html</li>
<li>https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects</li>
<li>https://rstats.wtf</li>
</ul>
<p>for more information on using projects and scripts</p>
</section>
<section id="worked-example-2.-object-assigments" class="level2">
<h2 class="anchored" data-anchor-id="worked-example-2.-object-assigments">Worked Example 2. Object assigments</h2>
<p>So far we have used R as a calculator. Next we’ll learn about how R stores data and applies data management or analysis functions to data. First some terminology:</p>
<section id="functions" class="level3">
<h3 class="anchored" data-anchor-id="functions">Functions</h3>
<p>Everything in R is done by executing ‘functions’. When you typed <code>1+2</code> at the console above you were calling the <code>+</code> function, with <code>1</code> and <code>2</code> as its arguments, and the result was printed in the console window.</p>
<p>Simple mathematical functions can be written using standard notation in this way (eg <code>1+2</code> or <code>3/4</code>) but functions are more commonly called by their <em>name</em>, with their <em>arguments</em> in brackets, separated by commas. For example, to get say the logarithm (base 10) of 100, we would type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Try this directly in the console, and by running it from your new script.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">x=</span><span class="dv">100</span>, <span class="at">base=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Here, <code>log</code> is the name of the function, with <code>x</code> and <code>base</code> its arguments. The result (2) is the <em>value</em> of the function (the value is what is returned).</p>
<p>Try each of the following commands. Do you understand what they do any why?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">### From now on, keep everything you try in a script file.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">x=</span><span class="dv">100</span>, <span class="at">base=</span><span class="dv">10</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">x=</span><span class="dv">100</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">base=</span><span class="dv">10</span>, <span class="at">x=</span><span class="dv">100</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">100</span>,<span class="dv">10</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1000</span> <span class="sc">|&gt;</span> <span class="fu">log</span>()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">|&gt;</span> <span class="fu">log</span>(<span class="at">base=</span><span class="dv">10</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>()</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="exercise-2.-get-help" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2.-get-help">Exercise 2. Get help!</h2>
<p>Type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>?log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>to read the help file for the <code>log</code> function. All R help files are structred in this way. Look at the <code>Usage</code>, <code>Arguments</code> and <code>Value</code> sections. These will be invaluable when you come to use R and use functions that you do not already know.</p>
<section id="objects" class="level3">
<h3 class="anchored" data-anchor-id="objects">Objects</h3>
<p>Instead of directly displaying the value of the function (‘value’ is what R calls the result of a function), you can give it a name and store it for later use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>=</code> in this context represents ‘assignment’. The line above says:</p>
<p>‘evaluate 1+2, and store the result in an object called x’ or more simply ‘assign the value of 1+2 to x’.</p>
<p>You might find it easier to understand:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This does exactly the same thing; some R users use the arrow <code>&lt;-</code> instead of <code>=</code> for assignment, so both forms will come up when you’re looking at help or other people’s code. I (annoyingly!) tend to use either interchangeably.</p>
<p>So now you have an object called <code>x</code> in your <em>environment</em> that holds the number 3. You can ask R to display the value of ‘x’ by just entering x (just entering the name of an object <em>prints</em> that object):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>Or you could do something else with <code>x</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.098612</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">|&gt;</span> <span class="fu">log</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.098612</code></pre>
</div>
</div>
<p>Note your new object and its value should now have appeared in the ‘Environment’ pane in RStudio.</p>
<p>To see the <em>class</em> of an object (what kind of thing is stored in the object), use the <code>class()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>Objects of different classes store different kinds of information. We will come across objects of many different classes later.</p>
</section>
</section>
<section id="exercise-3.-more-functions-and-assigning-values-to-variables" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3.-more-functions-and-assigning-values-to-variables">Exercise 3. More functions, and assigning values to variables</h2>
<ol type="1">
<li>Make a new object called y which has the value of x+3. Then display y.</li>
<li>Now change the value of x (eg using x &lt;- 6 ). Does the value of y change?</li>
<li>Objects can hold text strings instead of numbers. Try:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>myname <span class="ot">&lt;-</span> <span class="st">"George"</span>  <span class="co">#(or whatever your name is).</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>myname</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What is the class of the ‘myname’ object?</p>
<ol start="4" type="1">
<li>(Difficult!) Look up the function to turn a text string into upper case (an internet search will help you). Use this function to make a new object which has the same text as ‘myname’ but in upper case.</li>
</ol>
</section>
</section>
<section id="datasets" class="level1">
<h1>Datasets</h1>
<p>We can R as a calculator like this but we’ll most often be using R to analyse datasets.</p>
<p>Later we’ll look into getting real data into R, but for now we’ll work on a built-in dataset to understand how to run basic analyses. Type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check your ‘environment’ tab for a new object. Click on the object name to see it in the Viewer, or click on the small blue button next to it to expand the view in the environment window.</p>
<p>What is the class of the <code>iris</code> object that you have created?</p>
<p>There are a few different functions you can use to look at a dataset. Test each to see what they do.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(iris)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is an example of a dataset in <code>tidy</code> form. We’ll learn more about this in the next session, but in short in has:</p>
<ul>
<li>A single rectangular table to represent the data</li>
<li>A column for each variable</li>
<li>A row for each observation</li>
</ul>
<p>This is very similar to how datasets are stored in software like SPSS or Stata, or in a database, but is very different to how you might record data using GraphPad Prism.</p>
<p>We can extract individual variables like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Length</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or use functions to get descriptive statistics for a variable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Length)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or we can work on more than one variable at a time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(iris , <span class="fu">cor</span>(Sepal.Length , Sepal.Width))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tidyverse" class="level1">
<h1>Tidyverse</h1>
<p>Before we go any further we’re going to install a package. `Base’ R has a few ways to manipulate datasets, but these can get very cumbersome and you won’t use them much in practice so it’s better to start using add-on packages as soon as possible.</p>
<p>The two major packages of data wrangling functions are <code>data.table</code> and <code>tidyverse</code>.</p>
<p>Tidyverse is more widely used and so this is what we will focus on here. If you become more familiar with R you might want to explore <code>data.table</code>, which is used more by programmers.</p>
<p>Tidyverse is in fact a large set of packages. You can see all of the details here https://www.tidyverse.org/packages/. In particular we will use functions from the following packages:</p>
<ul>
<li><strong>readxl</strong> for reading data from excel files</li>
<li><strong>dplyr</strong> for data manipulation</li>
<li><strong>ggplot2</strong> for making graphics</li>
</ul>
<p>If you do not have the tidyverse installed, then install them now from the menu or by using</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will install a lot of packages and might take a few minutes.</p>
<p>The tidyverse packages are installed you can use all of their functions. There are two ways to use functions installed as part of a package. For example, to use the <code>glimpse</code> function from the <code>dplyr</code> package to look at the iris dataset, you can type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># or library(tidyverse)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using <code>library</code> adds the library to the search path for the whole of your R session, so R will be able to find all of the functions in this library without explicitly referencing the package every time.</p>
<p>What do each of the following functions do?</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>v ggplot2 3.3.5     v purrr   0.3.4
v tibble  3.1.6     v dplyr   1.0.8
v tidyr   1.2.0     v stringr 1.4.0
v readr   2.1.2     v forcats 0.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">select</span>(Sepal.Length, Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width
1            5.1         3.5
2            4.9         3.0
3            4.7         3.2
4            4.6         3.1
5            5.0         3.6
6            5.4         3.9
7            4.6         3.4
8            5.0         3.4
9            4.4         2.9
10           4.9         3.1
11           5.4         3.7
12           4.8         3.4
13           4.8         3.0
14           4.3         3.0
15           5.8         4.0
16           5.7         4.4
17           5.4         3.9
18           5.1         3.5
19           5.7         3.8
20           5.1         3.8
21           5.4         3.4
22           5.1         3.7
23           4.6         3.6
24           5.1         3.3
25           4.8         3.4
26           5.0         3.0
27           5.0         3.4
28           5.2         3.5
29           5.2         3.4
30           4.7         3.2
31           4.8         3.1
32           5.4         3.4
33           5.2         4.1
34           5.5         4.2
35           4.9         3.1
36           5.0         3.2
37           5.5         3.5
38           4.9         3.6
39           4.4         3.0
40           5.1         3.4
41           5.0         3.5
42           4.5         2.3
43           4.4         3.2
44           5.0         3.5
45           5.1         3.8
46           4.8         3.0
47           5.1         3.8
48           4.6         3.2
49           5.3         3.7
50           5.0         3.3
51           7.0         3.2
52           6.4         3.2
53           6.9         3.1
54           5.5         2.3
55           6.5         2.8
56           5.7         2.8
57           6.3         3.3
58           4.9         2.4
59           6.6         2.9
60           5.2         2.7
61           5.0         2.0
62           5.9         3.0
63           6.0         2.2
64           6.1         2.9
65           5.6         2.9
66           6.7         3.1
67           5.6         3.0
68           5.8         2.7
69           6.2         2.2
70           5.6         2.5
71           5.9         3.2
72           6.1         2.8
73           6.3         2.5
74           6.1         2.8
75           6.4         2.9
76           6.6         3.0
77           6.8         2.8
78           6.7         3.0
79           6.0         2.9
80           5.7         2.6
81           5.5         2.4
82           5.5         2.4
83           5.8         2.7
84           6.0         2.7
85           5.4         3.0
86           6.0         3.4
87           6.7         3.1
88           6.3         2.3
89           5.6         3.0
90           5.5         2.5
91           5.5         2.6
92           6.1         3.0
93           5.8         2.6
94           5.0         2.3
95           5.6         2.7
96           5.7         3.0
97           5.7         2.9
98           6.2         2.9
99           5.1         2.5
100          5.7         2.8
101          6.3         3.3
102          5.8         2.7
103          7.1         3.0
104          6.3         2.9
105          6.5         3.0
106          7.6         3.0
107          4.9         2.5
108          7.3         2.9
109          6.7         2.5
110          7.2         3.6
111          6.5         3.2
112          6.4         2.7
113          6.8         3.0
114          5.7         2.5
115          5.8         2.8
116          6.4         3.2
117          6.5         3.0
118          7.7         3.8
119          7.7         2.6
120          6.0         2.2
121          6.9         3.2
122          5.6         2.8
123          7.7         2.8
124          6.3         2.7
125          6.7         3.3
126          7.2         3.2
127          6.2         2.8
128          6.1         3.0
129          6.4         2.8
130          7.2         3.0
131          7.4         2.8
132          7.9         3.8
133          6.4         2.8
134          6.3         2.8
135          6.1         2.6
136          7.7         3.0
137          6.3         3.4
138          6.4         3.1
139          6.0         3.0
140          6.9         3.1
141          6.7         3.1
142          6.9         3.1
143          5.8         2.7
144          6.8         3.2
145          6.7         3.3
146          6.7         3.0
147          6.3         2.5
148          6.5         3.0
149          6.2         3.4
150          5.9         3.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">"setosa"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1           5.1         3.5          1.4         0.2  setosa
2           4.9         3.0          1.4         0.2  setosa
3           4.7         3.2          1.3         0.2  setosa
4           4.6         3.1          1.5         0.2  setosa
5           5.0         3.6          1.4         0.2  setosa
6           5.4         3.9          1.7         0.4  setosa
7           4.6         3.4          1.4         0.3  setosa
8           5.0         3.4          1.5         0.2  setosa
9           4.4         2.9          1.4         0.2  setosa
10          4.9         3.1          1.5         0.1  setosa
11          5.4         3.7          1.5         0.2  setosa
12          4.8         3.4          1.6         0.2  setosa
13          4.8         3.0          1.4         0.1  setosa
14          4.3         3.0          1.1         0.1  setosa
15          5.8         4.0          1.2         0.2  setosa
16          5.7         4.4          1.5         0.4  setosa
17          5.4         3.9          1.3         0.4  setosa
18          5.1         3.5          1.4         0.3  setosa
19          5.7         3.8          1.7         0.3  setosa
20          5.1         3.8          1.5         0.3  setosa
21          5.4         3.4          1.7         0.2  setosa
22          5.1         3.7          1.5         0.4  setosa
23          4.6         3.6          1.0         0.2  setosa
24          5.1         3.3          1.7         0.5  setosa
25          4.8         3.4          1.9         0.2  setosa
26          5.0         3.0          1.6         0.2  setosa
27          5.0         3.4          1.6         0.4  setosa
28          5.2         3.5          1.5         0.2  setosa
29          5.2         3.4          1.4         0.2  setosa
30          4.7         3.2          1.6         0.2  setosa
31          4.8         3.1          1.6         0.2  setosa
32          5.4         3.4          1.5         0.4  setosa
33          5.2         4.1          1.5         0.1  setosa
34          5.5         4.2          1.4         0.2  setosa
35          4.9         3.1          1.5         0.2  setosa
36          5.0         3.2          1.2         0.2  setosa
37          5.5         3.5          1.3         0.2  setosa
38          4.9         3.6          1.4         0.1  setosa
39          4.4         3.0          1.3         0.2  setosa
40          5.1         3.4          1.5         0.2  setosa
41          5.0         3.5          1.3         0.3  setosa
42          4.5         2.3          1.3         0.3  setosa
43          4.4         3.2          1.3         0.2  setosa
44          5.0         3.5          1.6         0.6  setosa
45          5.1         3.8          1.9         0.4  setosa
46          4.8         3.0          1.4         0.3  setosa
47          5.1         3.8          1.6         0.2  setosa
48          4.6         3.2          1.4         0.2  setosa
49          5.3         3.7          1.5         0.2  setosa
50          5.0         3.3          1.4         0.2  setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Sepal.Length <span class="sc">&gt;</span> <span class="fl">7.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
1          7.6         3.0          6.6         2.1 virginica
2          7.7         3.8          6.7         2.2 virginica
3          7.7         2.6          6.9         2.3 virginica
4          7.7         2.8          6.7         2.0 virginica
5          7.9         3.8          6.4         2.0 virginica
6          7.7         3.0          6.1         2.3 virginica</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Median Petal Width</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">median</span>(Petal.Width))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Median Petal Width
1                1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Mean</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">median</span>(Petal.Width), <span class="st">`</span><span class="at">SD</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sd</span>(Petal.Width))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Mean        SD
1  1.3 0.7622377</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Sepal.Area =</span> Sepal.Length <span class="sc">*</span> Sepal.Width) <span class="ot">-&gt;</span> iris2</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">arrange</span>(Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
1            4.3         3.0          1.1         0.1     setosa
2            4.4         2.9          1.4         0.2     setosa
3            4.4         3.0          1.3         0.2     setosa
4            4.4         3.2          1.3         0.2     setosa
5            4.5         2.3          1.3         0.3     setosa
6            4.6         3.1          1.5         0.2     setosa
7            4.6         3.4          1.4         0.3     setosa
8            4.6         3.6          1.0         0.2     setosa
9            4.6         3.2          1.4         0.2     setosa
10           4.7         3.2          1.3         0.2     setosa
11           4.7         3.2          1.6         0.2     setosa
12           4.8         3.4          1.6         0.2     setosa
13           4.8         3.0          1.4         0.1     setosa
14           4.8         3.4          1.9         0.2     setosa
15           4.8         3.1          1.6         0.2     setosa
16           4.8         3.0          1.4         0.3     setosa
17           4.9         3.0          1.4         0.2     setosa
18           4.9         3.1          1.5         0.1     setosa
19           4.9         3.1          1.5         0.2     setosa
20           4.9         3.6          1.4         0.1     setosa
21           4.9         2.4          3.3         1.0 versicolor
22           4.9         2.5          4.5         1.7  virginica
23           5.0         3.6          1.4         0.2     setosa
24           5.0         3.4          1.5         0.2     setosa
25           5.0         3.0          1.6         0.2     setosa
26           5.0         3.4          1.6         0.4     setosa
27           5.0         3.2          1.2         0.2     setosa
28           5.0         3.5          1.3         0.3     setosa
29           5.0         3.5          1.6         0.6     setosa
30           5.0         3.3          1.4         0.2     setosa
31           5.0         2.0          3.5         1.0 versicolor
32           5.0         2.3          3.3         1.0 versicolor
33           5.1         3.5          1.4         0.2     setosa
34           5.1         3.5          1.4         0.3     setosa
35           5.1         3.8          1.5         0.3     setosa
36           5.1         3.7          1.5         0.4     setosa
37           5.1         3.3          1.7         0.5     setosa
38           5.1         3.4          1.5         0.2     setosa
39           5.1         3.8          1.9         0.4     setosa
40           5.1         3.8          1.6         0.2     setosa
41           5.1         2.5          3.0         1.1 versicolor
42           5.2         3.5          1.5         0.2     setosa
43           5.2         3.4          1.4         0.2     setosa
44           5.2         4.1          1.5         0.1     setosa
45           5.2         2.7          3.9         1.4 versicolor
46           5.3         3.7          1.5         0.2     setosa
47           5.4         3.9          1.7         0.4     setosa
48           5.4         3.7          1.5         0.2     setosa
49           5.4         3.9          1.3         0.4     setosa
50           5.4         3.4          1.7         0.2     setosa
51           5.4         3.4          1.5         0.4     setosa
52           5.4         3.0          4.5         1.5 versicolor
53           5.5         4.2          1.4         0.2     setosa
54           5.5         3.5          1.3         0.2     setosa
55           5.5         2.3          4.0         1.3 versicolor
56           5.5         2.4          3.8         1.1 versicolor
57           5.5         2.4          3.7         1.0 versicolor
58           5.5         2.5          4.0         1.3 versicolor
59           5.5         2.6          4.4         1.2 versicolor
60           5.6         2.9          3.6         1.3 versicolor
61           5.6         3.0          4.5         1.5 versicolor
62           5.6         2.5          3.9         1.1 versicolor
63           5.6         3.0          4.1         1.3 versicolor
64           5.6         2.7          4.2         1.3 versicolor
65           5.6         2.8          4.9         2.0  virginica
66           5.7         4.4          1.5         0.4     setosa
67           5.7         3.8          1.7         0.3     setosa
68           5.7         2.8          4.5         1.3 versicolor
69           5.7         2.6          3.5         1.0 versicolor
70           5.7         3.0          4.2         1.2 versicolor
71           5.7         2.9          4.2         1.3 versicolor
72           5.7         2.8          4.1         1.3 versicolor
73           5.7         2.5          5.0         2.0  virginica
74           5.8         4.0          1.2         0.2     setosa
75           5.8         2.7          4.1         1.0 versicolor
76           5.8         2.7          3.9         1.2 versicolor
77           5.8         2.6          4.0         1.2 versicolor
78           5.8         2.7          5.1         1.9  virginica
79           5.8         2.8          5.1         2.4  virginica
80           5.8         2.7          5.1         1.9  virginica
81           5.9         3.0          4.2         1.5 versicolor
82           5.9         3.2          4.8         1.8 versicolor
83           5.9         3.0          5.1         1.8  virginica
84           6.0         2.2          4.0         1.0 versicolor
85           6.0         2.9          4.5         1.5 versicolor
86           6.0         2.7          5.1         1.6 versicolor
87           6.0         3.4          4.5         1.6 versicolor
88           6.0         2.2          5.0         1.5  virginica
89           6.0         3.0          4.8         1.8  virginica
90           6.1         2.9          4.7         1.4 versicolor
91           6.1         2.8          4.0         1.3 versicolor
92           6.1         2.8          4.7         1.2 versicolor
93           6.1         3.0          4.6         1.4 versicolor
94           6.1         3.0          4.9         1.8  virginica
95           6.1         2.6          5.6         1.4  virginica
96           6.2         2.2          4.5         1.5 versicolor
97           6.2         2.9          4.3         1.3 versicolor
98           6.2         2.8          4.8         1.8  virginica
99           6.2         3.4          5.4         2.3  virginica
100          6.3         3.3          4.7         1.6 versicolor
101          6.3         2.5          4.9         1.5 versicolor
102          6.3         2.3          4.4         1.3 versicolor
103          6.3         3.3          6.0         2.5  virginica
104          6.3         2.9          5.6         1.8  virginica
105          6.3         2.7          4.9         1.8  virginica
106          6.3         2.8          5.1         1.5  virginica
107          6.3         3.4          5.6         2.4  virginica
108          6.3         2.5          5.0         1.9  virginica
109          6.4         3.2          4.5         1.5 versicolor
110          6.4         2.9          4.3         1.3 versicolor
111          6.4         2.7          5.3         1.9  virginica
112          6.4         3.2          5.3         2.3  virginica
113          6.4         2.8          5.6         2.1  virginica
114          6.4         2.8          5.6         2.2  virginica
115          6.4         3.1          5.5         1.8  virginica
116          6.5         2.8          4.6         1.5 versicolor
117          6.5         3.0          5.8         2.2  virginica
118          6.5         3.2          5.1         2.0  virginica
119          6.5         3.0          5.5         1.8  virginica
120          6.5         3.0          5.2         2.0  virginica
121          6.6         2.9          4.6         1.3 versicolor
122          6.6         3.0          4.4         1.4 versicolor
123          6.7         3.1          4.4         1.4 versicolor
124          6.7         3.0          5.0         1.7 versicolor
125          6.7         3.1          4.7         1.5 versicolor
126          6.7         2.5          5.8         1.8  virginica
127          6.7         3.3          5.7         2.1  virginica
128          6.7         3.1          5.6         2.4  virginica
129          6.7         3.3          5.7         2.5  virginica
130          6.7         3.0          5.2         2.3  virginica
131          6.8         2.8          4.8         1.4 versicolor
132          6.8         3.0          5.5         2.1  virginica
133          6.8         3.2          5.9         2.3  virginica
134          6.9         3.1          4.9         1.5 versicolor
135          6.9         3.2          5.7         2.3  virginica
136          6.9         3.1          5.4         2.1  virginica
137          6.9         3.1          5.1         2.3  virginica
138          7.0         3.2          4.7         1.4 versicolor
139          7.1         3.0          5.9         2.1  virginica
140          7.2         3.6          6.1         2.5  virginica
141          7.2         3.2          6.0         1.8  virginica
142          7.2         3.0          5.8         1.6  virginica
143          7.3         2.9          6.3         1.8  virginica
144          7.4         2.8          6.1         1.9  virginica
145          7.6         3.0          6.6         2.1  virginica
146          7.7         3.8          6.7         2.2  virginica
147          7.7         2.6          6.9         2.3  virginica
148          7.7         2.8          6.7         2.0  virginica
149          7.7         3.0          6.1         2.3  virginica
150          7.9         3.8          6.4         2.0  virginica</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">logPetalLength =</span> <span class="fu">log</span>(Petal.Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using pipes you can chain functions together:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(Sepal.Length), <span class="fu">mean</span>(Sepal.Width), <span class="at">n=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="making-graphs-with-ggplot2" class="level1">
<h1>Making graphs with ggplot2</h1>
<p>R has a simple built in system for making graphs but the outputs are not very good!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The ggplot() system is much more flexible, and produces publication quality outputs:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width, <span class="at">color=</span>Species) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>Petal.Length, <span class="at">fill=</span>Species) <span class="sc">+</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We’ll see more ggplot in later sessions.</p>
</section>
<section id="types-of-data" class="level1">
<h1>Types of data</h1>
<p>We saw two object of two different ‘classes’ in the previous exercise. These classes were ‘numeric’ and ‘character’. The class of an object defines what kind of information it holds, and how other functions act on it.</p>
<p>There are four basic classes (modes) that you will commonly use and should be aware of. These correspond to the types of data you might have. The basic types are:</p>
<ul>
<li>‘numeric’ – For keeping numbers, can be discrete or continuous</li>
<li>‘logical’ – can only take the values (TRUE or FALSE)</li>
<li>‘character’ – for strings of text</li>
<li>‘factor’ – for labelled categorical variables (ordered or unordered)</li>
</ul>
<p>Later in this tutorial we will see objects of more complex classes, these can store lots of different information of different modes:</p>
<ul>
<li>‘data.frame’ – storing datasets</li>
<li>‘lm’ – stores the all results of a linear regression model</li>
</ul>
<section id="character-strings" class="level2">
<h2 class="anchored" data-anchor-id="character-strings">Character strings</h2>
<p>Character strings represent text rather than numbers. Strings are used to label categories in a dataset, to identify columns in a dataset, to make your outputs more readable. You also might find that part of your data has been entered as a string, for example patient identifiers or gene names in a database, or responses to open ended questions.</p>
<p>Strings are identified in R (and in most other programming languages) by enclosing them in quotes. Single quotes and double quotes can be used (and are treated almost identically), but double quotes are preferred. For example try:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Hello"</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'Hello'</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># What happens here?</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co">#print(Hello)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A common mistake in R is to forget to enclose strings in quotes. In which case R tries to interpret your input as an object name, leading to an error message if that name doesn’t exist.</p>
</section>
<section id="logicals" class="level2">
<h2 class="anchored" data-anchor-id="logicals">Logicals</h2>
<p>Logicals represent binary information in the form <code>TRUE</code> or <code>FALSE</code>. They most often arise as the result of a comparison, for example try:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">&gt;</span><span class="dv">2</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="st">"Hello"</span> <span class="sc">==</span> <span class="st">"hello"</span>  <span class="co"># note the double equals sign, this distinguishes assignment from comparison</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-between-types" class="level2">
<h2 class="anchored" data-anchor-id="converting-between-types">Converting between types</h2>
<p>Sometimes it is possible to convert an object from one class to another. For example, a number might be stored as a character string in your data, and you will need to convert it into a numeric before you can do any analysis with it. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">"3"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">*</span><span class="dv">2</span> <span class="co"># What is the error message here?  What does it mean?</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>y<span class="sc">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-elements-in-vectors" class="level2">
<h2 class="anchored" data-anchor-id="missing-elements-in-vectors">Missing elements in vectors</h2>
<p>Often your data will include missing values. R uses <code>NA</code> to represent missing values. For example the following creates a vector (a single variable, like a single column of a data frame) with a missing value in the fourth position:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>myvector <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">21</span>,<span class="dv">32</span>,<span class="cn">NA</span>,<span class="dv">54</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>myvector</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note the difference between <code>NA</code> (a missing value) and <code>"NA"</code> (a character string containing the letters N and A. I have been tripped up by this a few times when <code>"NA"</code> has been entered into a dataset.)</p>
</div>
</div>
</section>
<section id="exercise-4.-effect-of-missing-values" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4.-effect-of-missing-values">Exercise 4. Effect of missing values</h2>
<p>Try some other functions with myvector to see what impact the missing data point has.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(myvector)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(myvector)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>myvector<span class="sc">&gt;</span><span class="dv">20</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(myvector) <span class="co"># what happens here?  Why?  Can you fix it?</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(myvector) <span class="co"># what does this do?</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(myvector)) <span class="co"># can you explain what this does?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="citing-r-and-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="citing-r-and-r-packages">Citing R and R packages</h2>
<p>It is important to cite R and R packages you use correctly, particularly where the package is essential to make your analysis reproducible. To find out how to cite a package use the <code>citation()</code> function.</p>
<p>How should you cite the ‘tidyverse’ package?</p>
<p>`{r section(“Descriptive statistics”)}</p>
<p>In this section we’ll use combinations of base and Tidyverse functions to complete some common descriptive tasks.</p>
</section>
<section id="a-continuous-variable-stratified-by-a-grouping-variable-and-the-formula-interface" class="level2">
<h2 class="anchored" data-anchor-id="a-continuous-variable-stratified-by-a-grouping-variable-and-the-formula-interface">A continuous variable stratified by a grouping variable, and the formula interface</h2>
<p>Let’s get the sepal length by species. We can do this using the ‘aggregate’ function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aggregate</span>( Sepal.Length <span class="sc">~</span> Species, <span class="at">FUN=</span>mean, <span class="at">data =</span> iris )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although this is a relatively simple example, there is a lot to unpick in the syntax that is important for understanding how R analysis functions often work.</p>
<p>Here <code>aggregate()</code> uses the ‘formula’ interface, that is, its first argument is a <em>formula</em> of the form <code>y ~ x</code>. It’s important to understand this now because this is how variables are specified as arguments in many different R functions, eg to run analyses and to make graphics.</p>
<p>Formulas are generally used in R to specify relationships between variables in a dataset. Different functions use formulas in different ways, but in general the left hand side of a formula represents one or more dependent variables, and the right hand represents variables that act as predictors or grouping variables.</p>
<p>Look at the help file for <code>aggregate()</code> to understand how the rest of the arguments are specified. Note there is more than one syntax for <code>aggregate()</code> in the help file, since we gave a formula for the first argument R will choose the appropriate version of the function to use.</p>
<p><code>aggregate()</code> will use the function specified to its <code>FUN</code> argument to summarise the left-hand side variable, stratified by the right hand side variable.</p>
<p>How did R know where to find the objects ‘height’ and ‘species.name’? The final <code>data</code> argument tells aggregate where to look for the variables that have been specified in the formula. When you use <code>data=</code> like this in an R function it temporarily adds your data frame to the search path, so that R will find the vectors that you named in the formula.</p>
<p>Note, this way of using <code>data=</code> in a function doesn’t always work, only in those functions that explicitly allow it. So to get the mean heights in this dataset you can’t, for example, use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>( Sepal.Length, <span class="at">data=</span>iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>you would instead have to use either of the following:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Length)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(iris, <span class="fu">mean</span>(Sepal.Length)) <span class="co"># look up 'with' if you're interested!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We already saw a way to get means over a categorical variable with Tidyverse:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(Sepal.Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This is a situation where the tidyverse solution is no easier than the <code>base</code> solution, but the tidverse solution extends better. If we want more than one summary statistic for example, it’s easy with tidyverse but difficult with base:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">n</span>(),<span class="fu">mean</span>(Sepal.Length),<span class="fu">sd</span>(Sepal.Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-5.-medians-over-groups" class="level2">
<h2 class="anchored" data-anchor-id="exercise-5.-medians-over-groups">Exercise 5. Medians over groups</h2>
<ol type="1">
<li>Use <code>aggregate()</code> to find the maximum petal length, stratified by tree health.</li>
<li>Try the same thing using Tidyverse functions.</li>
</ol>
</section>
<section id="recoding-a-variable-into-groups" class="level2">
<h2 class="anchored" data-anchor-id="recoding-a-variable-into-groups">Recoding a variable into groups</h2>
<p>Suppose we want to classify flowers into three groups based on their petal length. We need to add another variable to the dataset.</p>
<p>What class should that variable be?</p>
<p>Base R has the function <code>cut</code> that</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cut_number</span>(iris<span class="sc">$</span>Petal.Length, <span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Short"</span>, <span class="st">"Medium"</span>, <span class="st">"Long"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using tidyverse to create this variable and add it to the dataset:</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">PetalLengthGrouped =</span> <span class="fu">cut_number</span>(Petal.Length, <span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Short"</span>, <span class="st">"Medium"</span>, <span class="st">"Long"</span>) )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tabulating-a-categorical-variable-over-groups" class="level2">
<h2 class="anchored" data-anchor-id="tabulating-a-categorical-variable-over-groups">Tabulating a categorical variable over groups</h2>
<p>For a categorical variable, a summary of frequency counts might be the most appropriate descriptive statistic. We can get this with the <code>table()</code> function. Suppose we wanted to know the distribution of species in our dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The ‘table’ function can also generate cross-tabs, by specifying two or three variables. Note here how they are defined using the accessor operator. <code>table()</code> does not use the forumula interface we discussed above, although the sister function <code>xtabs()</code> does.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species, iris<span class="sc">$</span>PetalLengthGrouped)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(  <span class="sc">~</span> Species <span class="sc">+</span> PetalLengthGrouped, <span class="at">data=</span>iris )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice the formula for <code>xtabs()</code> did not need a left hand side variable, both of the grouping factors are entered on the right hand side.</p>
<p>Tables of counts are useful, but it might be more helpful to see the proportion of healthy trees by species. To get this we can pass the table we just made into the prop.table() function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">table</span>(iris<span class="sc">$</span>Species, iris<span class="sc">$</span>PetalLengthGrouped)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(table1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
                  Short     Medium       Long
  setosa     0.33333333 0.00000000 0.00000000
  versicolor 0.00000000 0.32000000 0.01333333
  virginica  0.00000000 0.04000000 0.29333333</code></pre>
</div>
</div>
<p>This is where pipes might be more intuitive:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species, iris<span class="sc">$</span>PetalLengthGrouped) <span class="sc">|&gt;</span> <span class="fu">prop.table</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The table above has calculated the ‘cell proportions’. If we want the row percentages we need to set the <code>margin</code> option in <code>prop.table()</code> appropriately. <code>margin=1</code> is the rows, <code>margin=2</code> is the columns. If you left out margins altogether, you’d get the cell proportions.</p>
<p>We could round this (or any numeric) to 2 d.p. by passing the resulting proportion table into the <code>round()</code> function. and using the function <code>multiply_by</code> from the <code>magrittr</code> package (installed as part of tidyverse) we can turn our proportions into percentages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'magrittr' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'magrittr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    set_names</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    extract</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(iris<span class="sc">$</span>Species, iris<span class="sc">$</span>PetalLengthGrouped) <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prop.table</span>(<span class="at">margin=</span><span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">multiply_by</span>(<span class="dv">100</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
             Short Medium Long
  setosa       100      0    0
  versicolor     0     96    4
  virginica      0     12   88</code></pre>
</div>
</div>
</section>
</section>
<section id="hypothesis-tests" class="level1">
<h1>Hypothesis tests</h1>
<p>Does petal length depend on species? We can generate a simple box plot as previously to explore this question:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Base R method</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>( Petal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris , </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab=</span><span class="st">"Petal Length"</span>, </span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab=</span><span class="st">"Species"</span>,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"red"</span>) <span class="co"># Note the use of a multi-line command in a script!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot2 method</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"red"</span>) <span class="sc">+</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Species"</span>, <span class="at">y=</span><span class="st">"Petal Length"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-43-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It looks like the two variables are related, but we would like to perform a hypothesis test to see if the difference is statistically significant, and to get an estimate (with confidence interval) for the difference.</p>
<p>The syntax for the ANOVA is almost exactly the same as that used to generate the box plot. We use the same formula <code>height~health</code> to again specify that height depends on health in our analysis:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">aov</span>( Sepal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get the coefficients (mean differences between groups) we can estimate a linear model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris) <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then use either the base function <code>confint</code> or the <code>tidy</code> function from the <code>broom</code> package (installed with tidyverse) to get the confidence intervals for those differences:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R methods:</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris) <span class="sc">|&gt;</span> <span class="fu">confint</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      2.5 %   97.5 %
(Intercept)       4.8621258 5.149874
Speciesversicolor 0.7265312 1.133469
Speciesvirginica  1.3785312 1.785469</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyverse method:</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris) <span class="sc">|&gt;</span> broom<span class="sc">::</span><span class="fu">tidy</span>(<span class="at">conf.int=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 7
  term              estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)          5.01     0.0728     68.8  1.13e-113    4.86       5.15
2 Speciesversicolor    0.930    0.103       9.03 8.77e- 16    0.727      1.13
3 Speciesvirginica     1.58     0.103      15.4  2.21e- 32    1.38       1.79</code></pre>
</div>
</div>
<p>Finally, we can use <code>augment</code> from the <code>broom</code> package to add predicted values to our dataset, with confidence intervals, and plot these with <code>ggplot</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'broom' was built under R version 4.1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species <span class="sc">*</span> Petal.Length, <span class="at">data=</span>iris) <span class="sc">|&gt;</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">interval=</span><span class="st">"confidence"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>Petal.Length, <span class="at">y=</span>Sepal.Length, <span class="at">color=</span>Species) <span class="sc">+</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted,<span class="at">ymin=</span>.lower, <span class="at">ymax=</span>.upper), <span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted),<span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>