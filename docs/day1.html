<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="George Savva, QIB">
<meta name="author" content="Pirita Paajanen, JIC">
<meta name="dcterms.date" content="2024-04-01">

<title>R and Statistics - Introduction to ‘R’ for statistical analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Statistics and R in Biology</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target=""><i class="bi bi-fa-home" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-intro-to-r-for-statistics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Intro to R for Statistics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-intro-to-r-for-statistics">    
        <li>
    <a class="dropdown-item" href="./day1.html" rel="" target="">
 <span class="dropdown-text">NBI PhD Intro to R Day 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./day2.html" rel="" target="">
 <span class="dropdown-text">NBI PhD Intro to R Day 2/3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./workshopscript.html" rel="" target="">
 <span class="dropdown-text">JIC MSc Workshop (2021/2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./flipbook.html" rel="" target="">
 <span class="dropdown-text">ggplot example</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./irisScript.html" rel="" target="">
 <span class="dropdown-text">Iris data walkthough</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistics-notes" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Statistics notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistics-notes">    
        <li>
    <a class="dropdown-item" href="./day3.html" rel="" target="">
 <span class="dropdown-text">Notes on graphing</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./dichot.html" rel="" target="">
 <span class="dropdown-text">Do not group your data points</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./alphabeta.html" rel="" target="">
 <span class="dropdown-text">Simple alpha and beta diversity simulation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./berkson.html" rel="" target="">
 <span class="dropdown-text">Selection bias (Berkson bias) in observational studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./independentclusters.html" rel="" target="">
 <span class="dropdown-text">Sampling from clustered data in observational studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./repeats.html" rel="" target="">
 <span class="dropdown-text">Run bigger experiments instead of internal replications</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="mailto:george.savva@quadram.ac.uk" rel="" target=""><i class="bi bi-fa-envelope-o" role="img">
</i> 
 <span class="menu-text">Contact me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/georgemsavva" rel="" target=""><i class="bi bi-fa-github" role="img">
</i> 
 <span class="menu-text">GitHub</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link" data-scroll-target="#learning-objectives"><span class="header-section-number">1.1</span> Learning objectives</a></li>
  </ul></li>
  <li><a href="#r-and-rstudio" id="toc-r-and-rstudio" class="nav-link" data-scroll-target="#r-and-rstudio"><span class="header-section-number">2</span> R and RStudio</a>
  <ul class="collapse">
  <li><a href="#what-are-r-and-rstudio" id="toc-what-are-r-and-rstudio" class="nav-link" data-scroll-target="#what-are-r-and-rstudio"><span class="header-section-number">2.1</span> What are R and RStudio?</a></li>
  <li><a href="#getting-r-and-rstudio" id="toc-getting-r-and-rstudio" class="nav-link" data-scroll-target="#getting-r-and-rstudio"><span class="header-section-number">2.2</span> Getting R and RStudio</a></li>
  <li><a href="#starting-rstudio" id="toc-starting-rstudio" class="nav-link" data-scroll-target="#starting-rstudio"><span class="header-section-number">2.3</span> Starting RStudio</a></li>
  <li><a href="#check-r-and-rstudio-are-working-run-your-first-command" id="toc-check-r-and-rstudio-are-working-run-your-first-command" class="nav-link" data-scroll-target="#check-r-and-rstudio-are-working-run-your-first-command"><span class="header-section-number">2.4</span> Check R and RStudio are working, run your first command</a></li>
  </ul></li>
  <li><a href="#using-projects-and-scripts" id="toc-using-projects-and-scripts" class="nav-link" data-scroll-target="#using-projects-and-scripts"><span class="header-section-number">3</span> Using projects and scripts</a>
  <ul class="collapse">
  <li><a href="#making-a-script" id="toc-making-a-script" class="nav-link" data-scroll-target="#making-a-script"><span class="header-section-number">3.1</span> Making a script</a></li>
  </ul></li>
  <li><a href="#objects-and-functions" id="toc-objects-and-functions" class="nav-link" data-scroll-target="#objects-and-functions"><span class="header-section-number">4</span> Objects and functions</a>
  <ul class="collapse">
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions"><span class="header-section-number">4.1</span> Functions</a></li>
  <li><a href="#objects" id="toc-objects" class="nav-link" data-scroll-target="#objects"><span class="header-section-number">4.2</span> Objects</a></li>
  <li><a href="#test-yourself" id="toc-test-yourself" class="nav-link" data-scroll-target="#test-yourself"><span class="header-section-number">4.3</span> Test yourself</a></li>
  </ul></li>
  <li><a href="#using-r-to-analyse-data" id="toc-using-r-to-analyse-data" class="nav-link" data-scroll-target="#using-r-to-analyse-data"><span class="header-section-number">5</span> Using R to analyse data</a>
  <ul class="collapse">
  <li><a href="#download-and-explore-the-structure-of-the-dataset-in-excel" id="toc-download-and-explore-the-structure-of-the-dataset-in-excel" class="nav-link" data-scroll-target="#download-and-explore-the-structure-of-the-dataset-in-excel"><span class="header-section-number">5.1</span> Download and explore the structure of the dataset in Excel</a></li>
  <li><a href="#exercise" id="toc-exercise" class="nav-link" data-scroll-target="#exercise"><span class="header-section-number">5.2</span> Exercise</a></li>
  <li><a href="#explore-the-structure-of-the-dataset-using-r" id="toc-explore-the-structure-of-the-dataset-using-r" class="nav-link" data-scroll-target="#explore-the-structure-of-the-dataset-using-r"><span class="header-section-number">5.3</span> Explore the structure of the dataset using R</a></li>
  <li><a href="#use-the-data-in-calculations" id="toc-use-the-data-in-calculations" class="nav-link" data-scroll-target="#use-the-data-in-calculations"><span class="header-section-number">5.4</span> Use the data in calculations</a></li>
  <li><a href="#test-yourself---more-exploration-of-the-iris-dataset" id="toc-test-yourself---more-exploration-of-the-iris-dataset" class="nav-link" data-scroll-target="#test-yourself---more-exploration-of-the-iris-dataset"><span class="header-section-number">5.5</span> Test yourself - More exploration of the iris dataset</a></li>
  <li><a href="#other-packages-for-descriptive-statistics-if-you-have-time" id="toc-other-packages-for-descriptive-statistics-if-you-have-time" class="nav-link" data-scroll-target="#other-packages-for-descriptive-statistics-if-you-have-time"><span class="header-section-number">5.6</span> Other packages for descriptive statistics (if you have time)</a></li>
  </ul></li>
  <li><a href="#tidyverse" id="toc-tidyverse" class="nav-link" data-scroll-target="#tidyverse"><span class="header-section-number">6</span> Tidyverse</a>
  <ul class="collapse">
  <li><a href="#using-a-function-from-dplyr" id="toc-using-a-function-from-dplyr" class="nav-link" data-scroll-target="#using-a-function-from-dplyr"><span class="header-section-number">6.1</span> Using a function from <code>dplyr</code></a></li>
  <li><a href="#using-dplyr-functions-to-manipulate-and-summarise-data" id="toc-using-dplyr-functions-to-manipulate-and-summarise-data" class="nav-link" data-scroll-target="#using-dplyr-functions-to-manipulate-and-summarise-data"><span class="header-section-number">6.2</span> Using dplyr functions to manipulate and summarise data</a></li>
  <li><a href="#test-yourself-data-wrangling-and-summarising" id="toc-test-yourself-data-wrangling-and-summarising" class="nav-link" data-scroll-target="#test-yourself-data-wrangling-and-summarising"><span class="header-section-number">6.3</span> Test yourself: data wrangling and summarising</a></li>
  </ul></li>
  <li><a href="#graphics" id="toc-graphics" class="nav-link" data-scroll-target="#graphics"><span class="header-section-number">7</span> Graphics</a></li>
  <li><a href="#hypothesis-tests-and-linear-models" id="toc-hypothesis-tests-and-linear-models" class="nav-link" data-scroll-target="#hypothesis-tests-and-linear-models"><span class="header-section-number">8</span> Hypothesis tests and linear models</a>
  <ul class="collapse">
  <li><a href="#test-yourself-model-outputs" id="toc-test-yourself-model-outputs" class="nav-link" data-scroll-target="#test-yourself-model-outputs"><span class="header-section-number">8.1</span> Test yourself (model outputs)</a></li>
  <li><a href="#further-uses-of-linear-models." id="toc-further-uses-of-linear-models." class="nav-link" data-scroll-target="#further-uses-of-linear-models."><span class="header-section-number">8.2</span> Further uses of linear models.</a></li>
  <li><a href="#more-complex-models-interactions-and-multiple-regression" id="toc-more-complex-models-interactions-and-multiple-regression" class="nav-link" data-scroll-target="#more-complex-models-interactions-and-multiple-regression"><span class="header-section-number">8.3</span> More complex models (interactions and multiple regression)</a></li>
  </ul></li>
  <li><a href="#extra-material-below-here" id="toc-extra-material-below-here" class="nav-link" data-scroll-target="#extra-material-below-here"><span class="header-section-number">9</span> Extra material below here</a>
  <ul class="collapse">
  <li><a href="#more-detail-on-types-and-classes" id="toc-more-detail-on-types-and-classes" class="nav-link" data-scroll-target="#more-detail-on-types-and-classes"><span class="header-section-number">9.1</span> More detail on types and classes</a></li>
  <li><a href="#character-strings" id="toc-character-strings" class="nav-link" data-scroll-target="#character-strings"><span class="header-section-number">9.2</span> Character strings</a></li>
  <li><a href="#logicals" id="toc-logicals" class="nav-link" data-scroll-target="#logicals"><span class="header-section-number">9.3</span> Logicals</a></li>
  <li><a href="#converting-between-types" id="toc-converting-between-types" class="nav-link" data-scroll-target="#converting-between-types"><span class="header-section-number">9.4</span> Converting between types</a></li>
  <li><a href="#missing-elements-in-vectors" id="toc-missing-elements-in-vectors" class="nav-link" data-scroll-target="#missing-elements-in-vectors"><span class="header-section-number">9.5</span> Missing elements in vectors</a></li>
  <li><a href="#exercise-1.-effect-of-missing-values" id="toc-exercise-1.-effect-of-missing-values" class="nav-link" data-scroll-target="#exercise-1.-effect-of-missing-values"><span class="header-section-number">9.6</span> Exercise 1. Effect of missing values</a></li>
  </ul></li>
  <li><a href="#more-descriptive-statistics" id="toc-more-descriptive-statistics" class="nav-link" data-scroll-target="#more-descriptive-statistics"><span class="header-section-number">10</span> More descriptive statistics</a>
  <ul class="collapse">
  <li><a href="#a-continuous-variable-stratified-by-a-grouping-variable-and-the-formula-interface" id="toc-a-continuous-variable-stratified-by-a-grouping-variable-and-the-formula-interface" class="nav-link" data-scroll-target="#a-continuous-variable-stratified-by-a-grouping-variable-and-the-formula-interface"><span class="header-section-number">10.1</span> A continuous variable stratified by a grouping variable, and the formula interface</a></li>
  <li><a href="#recoding-a-variable-into-groups" id="toc-recoding-a-variable-into-groups" class="nav-link" data-scroll-target="#recoding-a-variable-into-groups"><span class="header-section-number">10.2</span> Recoding a variable into groups</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introduction to ‘R’ for statistical analysis</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>George Savva, QIB </p>
             <p>Pirita Paajanen, JIC </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 1, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>This course will introduce</p>
<ul>
<li>R and RStudio statistical software</li>
<li>Examples of performing common tasks in scientific data analysis
<ul>
<li>Loading data</li>
<li>Descriptive analysis</li>
<li>Basic testing and modelling</li>
<li>Making graphics</li>
</ul></li>
<li>Where to go for further support</li>
</ul>
<p>The aim is to become familiar with the R/RStudio environment and some common functions and workflows. This will enable you to learn the specific functions that you need on your own or with further training.</p>
<p>Powerpoint slides for today’s session are here:</p>
<ul>
<li><a href="day1.pptx">Day 1 slides</a></li>
</ul>
<p>This handout was written in RStudio using the Quarto document preparation system. The source code is here: <a href="./day1.html">day1.qmd</a></p>
<section id="learning-objectives" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">1.1</span> Learning objectives</h2>
<p>We will focus on the tasks used in a typical analysis of a single scientific dataset, mirroring the tasks usually conducted in other statistical software.</p>
<section id="specific-tasks" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="specific-tasks"><span class="header-section-number">1.1.1</span> Specific tasks:</h3>
<p>Day 1: R and RStudio basics</p>
<ul>
<li>Familiarity with R and RStudio</li>
<li>The R language and R scripts</li>
<li>Exploring data and calculating descriptive statistics using example data</li>
</ul>
<p>Day 2/3: Importing data, cleaning, coding and typical analysis workflow</p>
<ul>
<li>Revise and consolidate day 1 learning</li>
<li>Loading and wrangling data</li>
<li>Simple hypothesis tests</li>
<li>Estimating, diagnosing and interpreting linear models</li>
<li>Making graphs using the ggplot2 package</li>
</ul>
</section>
</section>
</section>
<section id="r-and-rstudio" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> R and RStudio</h1>
<section id="what-are-r-and-rstudio" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="what-are-r-and-rstudio"><span class="header-section-number">2.1</span> What are R and RStudio?</h2>
<p><strong>R</strong> is a free and open source statistics package, initially developed during the 1990s, and that has now become the world’s most widely used and comprehensive statistical software. R calls itself a <em>programming language and environment for statistic computing</em>.</p>
<p>That is, ‘R’ refers both to the software itself and the programming language that you use to interact with it.</p>
<p><strong>RStudio</strong> is a free open source integrated development environment (IDE) for R that makes working R much easier. Most R users use RStudio and we recommend using RStudio for new users.</p>
<p>The great strength of R is in its contributed packages, these are community written add-ons that make R much more powerful and easy to use. We will introduce some commonly used packages for data management, analysis and graphing during this course.</p>
</section>
<section id="getting-r-and-rstudio" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="getting-r-and-rstudio"><span class="header-section-number">2.2</span> Getting R and RStudio</h2>
<ul>
<li><p>If you are using a PC in the JIC IT training suite it will already have an up-to-date version of R and RStudio.</p></li>
<li><p>For other NBI managed devices you can install R and RStudio from the NBI software catalogue.</p></li>
<li><p>If you want to install R and RStudio on your own device:</p>
<ol type="1">
<li><p>Download and install the latest version of R from <a href="https://cran.r-project.org/" class="uri">https://cran.r-project.org/</a></p></li>
<li><p>Then download and install RStudio from <a href="https://www.rstudio.com/" class="uri">https://www.rstudio.com/</a></p></li>
</ol></li>
</ul>
</section>
<section id="starting-rstudio" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="starting-rstudio"><span class="header-section-number">2.3</span> Starting RStudio</h2>
<p>Start RStudio. It will detect your installation of R, and you should see a screen like this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="rstudio.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure: RStudio Window</figcaption>
</figure>
</div>
<p>On the left is the console window, where you type commands and see output. The windows on the right hold various useful tabs, including your data, graphs, help files, and your command history.</p>
</section>
<section id="check-r-and-rstudio-are-working-run-your-first-command" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="check-r-and-rstudio-are-working-run-your-first-command"><span class="header-section-number">2.4</span> Check R and RStudio are working, run your first command</h2>
<ol type="1">
<li>Click in the console window and type:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Press return on your keyboard. You should see:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Try a few other mathematical functions at the R console (eg):</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sin</span>(pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">10</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fl">1e4</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span><span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do you understand the output from each of these commands?</p>
</section>
</section>
<section id="using-projects-and-scripts" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Using projects and scripts</h1>
<p>Before we go any further, we are going to start an RStudio ‘project’ to organise our work during this course. Using projects helps us to keep all of the data and analysis for a particular piece of work in the same place.</p>
<ul>
<li>Click on ‘New → New project’ in the main toolbar.<br>
</li>
<li>Click ‘Start a new project in a brand new working directory’.<br>
</li>
<li>Finally click ‘new project’ on the next screen.</li>
</ul>
<p>Now you can choose where to create the new directory for your R project, and what to call it.</p>
<ul>
<li><p>Make a project called ‘Rtraining’ or something like that, somewhere in your <em>personal filestore</em> (U drive).</p></li>
<li><p><strong>If you are not comfortable making directories and working with files in your personal filestore, we’ll fix that now because it’s important!</strong></p></li>
</ul>
<p>Now, when you return to the main RStudio window you are working within your project. Notice that:</p>
<ul>
<li>The ‘working directory’ has automatically switched to the new directory that you created.</li>
<li>The ‘files’ tab on the bottom left of the window is now showing the root of the project directory.</li>
</ul>
<p>In practice an RStudio project directory should include all of the data files, source files and generated results corresponding to an analysis project. Eg for each paper I work on I tend to keep an RStudio project including all of the data files and scripts for that project. Using projects also help you to work with version control systems (like Github).</p>
<section id="making-a-script" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="making-a-script"><span class="header-section-number">3.1</span> Making a script</h2>
<p>We could do everything by typing commands into the console window as we have already seen, but this is not good if we want to remember or repeat something we have done, or share it with others.</p>
<p>So instead we will type our commands into files called R <em>scripts</em> and run the commands from there. With a script you can run and re-run bigger analyses that chain together all the functions you need for data loading, cleaning, analysing, reporting etc. R scripts have the file extension</p>
<p>Using scripts mean we can develop complex analyses, and that when we come back to them later, eg if something changes in our data that means we need to redo everything, or we want to tweak something in our analysis because of a reviewer’s comment, we can easily do this.</p>
<p>::: {.callout-tip title=“Always use a project, and keep scripts tidy!}</p>
<p>It is good to keep a separate R script for each analysis that you do, such that each starts with the functions to load the required data, then do any cleaning or coding that is necessary, then to perform and report the data analysis.</p>
<p>If you start making more complex projects you may want to write separate scripts for each of these elements.</p>
<p>:::</p>
<section id="look-at-some-example-r-scripts" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="look-at-some-example-r-scripts"><span class="header-section-number">3.1.1</span> Look at some example R scripts</h3>
<p>An example R script, annotated with comments, is in the files that accompany this handout. Let’s look at it now:</p>
<ul>
<li><a href="exampleScript.R">Example R script</a></li>
</ul>
<p>Load this script in R studio and practice running lines one at a time, or ‘sourcing’ the whole script all at once (see the section below for how to do this).</p>
<p>There is a second R script, including an analysis of the <code>iris</code> dataset that we’ll use today:</p>
<ul>
<li><a href="irisScript.R">Iris analysis R script</a></li>
</ul>
<p>The iris script has also been ‘spun’ into a report, which you can see here:</p>
<ul>
<li><a href="./irisScript.html">Iris report</a></li>
</ul>
<p>We won’t cover making reports, websites or presentations in this course, but you should look into the Quarto system if you are interested.</p>
</section>
<section id="make-a-new-script" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="make-a-new-script"><span class="header-section-number">3.1.2</span> Make a new script</h3>
<ol type="1">
<li><p>Make a new script. Click on File → New File → R Script in the main RStudio window. An empty file will appear in the top-left pane.</p></li>
<li><p>Save your script with a sensible filename (even though it is empty). Having unsaved scripts is a bad idea, RStudio is sometimes unstable and while it will try to recover unsaved work it is not always guaranteed to. Get into the habit of saving your scripts regularly. Make sure it has the file extension <code>.R</code></p></li>
<li><p>Put some of the mathematical functions that you have already tried into your script, with one on each line.</p></li>
</ol>
<p>You can now run code from scripts in several ways. Try each of these:</p>
<ol type="1">
<li><p>Press ‘run’ or type Ctrl+Enter on the keyboard, RStudio will send the line that the cursor is on to the R console and will run it.</p></li>
<li><p>If you highlight an area of the script and then hit ‘run’ (or press Ctrl+Enter) then RStudio will send all the highlighted code to the R console.</p></li>
<li><p>If you save the file, then press ‘source’, R will load the file from disk and run all the commands from that file in sequence.</p></li>
</ol>
<p>If you have your raw data saved, and you keep your scripts, then you don’t need to save your results or any of the variables that you generated or modified during your analysis. So long as the original data doesn’t change, running the script will reproduce all of your analysis and output. This is usually a better way of working than trying to save your environment with all of your results and tables in.</p>
<p>See also:</p>
<ul>
<li><a href="https://kdestasio.github.io/post/r_best_practices/" class="uri">https://kdestasio.github.io/post/r_best_practices/</a></li>
<li><a href="https://r4ds.had.co.nz/workflow-projects.html" class="uri">https://r4ds.had.co.nz/workflow-projects.html</a></li>
<li><a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects" class="uri">https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects</a></li>
<li><a href="https://rstats.wtf" class="uri">https://rstats.wtf</a></li>
</ul>
<p>for more information on using projects and scripts</p>
<p>For more complex projects you might be interested in using a pipeline tool such like <code>targets</code> to help keep your work organised, particularly if you are running analyses in multiple stages with some elements taking a long time.</p>
<ul>
<li><a href="https://books.ropensci.org/targets/" class="uri">https://books.ropensci.org/targets/</a></li>
</ul>
</section>
</section>
</section>
<section id="objects-and-functions" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Objects and functions</h1>
<p>So far we have used R as a calculator. Next we’ll see how R stores objects and applies functions to data.</p>
<p>(Optional - a tutorial on packages, function and pipes using the <code>cowsay</code>, <code>praise</code> and <code>spongebob</code> packages.) <a href="./praise.html">Objects, functions, packages and pipes tutorial</a></p>
<section id="functions" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="functions"><span class="header-section-number">4.1</span> Functions</h2>
<p>Everything in R is done by executing ‘functions’. When you typed <code>1+2</code> at the console above you were calling the <code>+</code> function, with <code>1</code> and <code>2</code> as its arguments, and the result was printed in the console window.</p>
<p>Simple mathematical functions can be written using standard notation in this way (eg <code>1+2</code> or <code>3/4</code>) but functions are more commonly called by their <em>name</em>, with their <em>arguments</em> in brackets, separated by commas. For example, to get say the logarithm (base 10) of 100, we would type</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Try this directly in the console, and by running it from your new script.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">x=</span><span class="dv">100</span>, <span class="at">base=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<p>Here, <code>log</code> is the name of the function, with <code>x</code> and <code>base</code> its arguments. The result is the <em>value</em> of the function (the value is what is returned).</p>
<ul>
<li>Try each of the following commands. Do you understand what they do any why?</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">### From now on, keep everything you try in a script file.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">x=</span><span class="dv">100</span>, <span class="at">base=</span><span class="dv">10</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">x=</span><span class="dv">100</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="at">base=</span><span class="dv">10</span>, <span class="at">x=</span><span class="dv">100</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">100</span>,<span class="dv">10</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="dv">1000</span> <span class="sc">|&gt;</span> <span class="fu">log</span>()           <span class="co">#  Note the use of the pipe operator |&gt; as an alternative way to call a function. </span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span> <span class="sc">|&gt;</span> <span class="fu">log</span>(<span class="at">base=</span><span class="dv">10</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>()</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="getting-help" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="getting-help"><span class="header-section-number">4.1.1</span> Getting help</h3>
<p>Let’s find out why the <code>log</code> command we used in the last section worked the way it did. In the console, type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>?log</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>to read the help file for the <code>log</code> function. All R help files are structured in a similar way, so it’s useful to understand this now for a simple function like <code>log</code>.</p>
<p>Look at the <code>Usage</code>, <code>Arguments</code> and <code>Value</code> sections. These will be invaluable when you come to use R and use functions that you do not already know.</p>
</section>
</section>
<section id="objects" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="objects"><span class="header-section-number">4.2</span> Objects</h2>
<p>Instead of directly displaying the value of the function (‘value’ is what R calls the result of a function), you can give it a name and store it for later use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">+</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This does exactly the same thing; some R users use the arrow <code>&lt;-</code> instead of <code>=</code> for assignment, so both forms will come up when you’re looking at help files or other people’s code. I (annoyingly!) tend to use either interchangeably.</p>
<p>Now you have an object called <code>x</code> in your <em>environment</em> that holds the number 3 (check your environment window). You can ask R to display the value of ‘x’ by just entering x (just entering the name of an object <em>prints</em> that object):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Or you could do something else with <code>x</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(x)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">|&gt;</span> <span class="fu">log</span>()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>x <span class="sc">|&gt;</span> <span class="fu">log</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What does this do?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">|&gt;</span> <span class="fu">log</span>() <span class="sc">|&gt;</span> <span class="fu">sqrt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hint: it might help to understand if you read the pipe operator <code>|&gt;</code> as “and then…”</p>
<p>To see the <em>class</em> of an object (what kind of thing is stored in the object), use the <code>class()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Objects of different classes store different kinds of information. We will come across objects of different classes later.</p>
</section>
<section id="test-yourself" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="test-yourself"><span class="header-section-number">4.3</span> Test yourself</h2>
<ol type="1">
<li>Make a new object called y which has the value of x+3. Then display y.</li>
<li>Now change the value of x (eg using <code>x &lt;- 6</code> ). Does the value of y change?</li>
<li>Objects can hold text strings instead of numbers. Try:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>myname <span class="ot">&lt;-</span> <span class="st">"George"</span>  <span class="co"># (or whatever your name is).</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>myname</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What is the class of the ‘myname’ object?</p>
<ol start="4" type="1">
<li>(Difficult!) Look up the function to turn a text string into upper case (an internet search will help you). Use this function to make a new object which has the same text as ‘myname’ but in upper case.</li>
</ol>
</section>
</section>
<section id="using-r-to-analyse-data" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Using R to analyse data</h1>
<p>We can R as a simple calculator like this but we’ll most often be using R to analyse datasets.</p>
<p>We’ll load a simple dataset into R, and do some analysis.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are two types of statistical analysis:</p>
<p><em>Descriptive</em> statistics are used to describe the sample.</p>
<p>We use <em>analytic</em> (or <em>inferential</em>) statistics to test our hypotheses, estimate treatment effects and learn about populations.</p>
<p>Both types are important!</p>
</div>
</div>
<section id="download-and-explore-the-structure-of-the-dataset-in-excel" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="download-and-explore-the-structure-of-the-dataset-in-excel"><span class="header-section-number">5.1</span> Download and explore the structure of the dataset in Excel</h2>
<p>The ‘iris’ dataset is stored in a comma-separated value file here <a href="iris.csv">iris.csv</a></p>
<p>Download the dataset and have a look around in Excel. Note the structure of the dataset</p>
<p>The <code>iris</code> data is an example of a dataset in <em>tidy</em> form. We’ll learn more about this in the next session, but in short in has:</p>
<ul>
<li>A single rectangular table to represent the data</li>
<li>A column for each variable (characteristic)</li>
<li>A row for each observation (flower in this case)</li>
</ul>
<p>This is very similar to how datasets are stored in software like SPSS or Stata, or in a database, but is different to how you might record data using GraphPad Prism. We’ll see more about how to arrange data like this later in the course.</p>
<p>Make sure the dataset is stored in the root directory of your project.</p>
<p>Start a new script to begin your analysis of the ‘iris’ dataset.</p>
<p>We can use the <code>read.csv</code> function to load data from a csv file (later we’ll see how to import Excel format data). Type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"iris.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Check your ‘environment’ tab for a new object. Click on the object name to see it in the Viewer, or click on the small blue button next to it to expand the view in the environment window.</p>
</section>
<section id="exercise" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="exercise"><span class="header-section-number">5.2</span> Exercise</h2>
<ol type="1">
<li><p>What is the class of the <code>iris</code> object that you have created?</p></li>
<li><p>What is included in this data?</p></li>
<li><p>What kind of descriptive statistics might we calculate to learn about this dataset?</p></li>
<li><p>What kind of analytic (inferential) questions might we ask of the data?</p></li>
</ol>
</section>
<section id="explore-the-structure-of-the-dataset-using-r" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="explore-the-structure-of-the-dataset-using-r"><span class="header-section-number">5.3</span> Explore the structure of the dataset using R</h2>
<p>There are a few different functions you can use to explore a dataset. Test each with the <code>iris</code> data to see what they do.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(iris)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="use-the-data-in-calculations" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="use-the-data-in-calculations"><span class="header-section-number">5.4</span> Use the data in calculations</h2>
<p>We can extract individual variables (characteristics) and individual elements like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Length </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What do these lines do?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Length[<span class="dv">1</span>]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Length[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)]</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Length[<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span><span class="sc">:</span><span class="dv">20</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What does this do?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris, <span class="at">col=</span>iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>iris$Sepal.length</code> is a ‘vector’. A vector is a list of items all of the same type. Here its a vector of numbers. A data frame is a collection of vectors.</p>
<p>What are the types of each of the other vectors in the <code>iris</code> data frame?</p>
</div>
</div>
<p>We can use different R functions to get descriptive statistics for a vector. Try each of these functions and see if you can understand what it does:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Length)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Length <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(iris<span class="sc">$</span>Sepal.Length)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Sepal.Width <span class="sc">|&gt;</span> <span class="fu">hist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can work on more than one variable at a time:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(iris<span class="sc">$</span>Sepal.Length, iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(iris , <span class="fu">cor</span>(Sepal.Length , Sepal.Width))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="test-yourself---more-exploration-of-the-iris-dataset" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="test-yourself---more-exploration-of-the-iris-dataset"><span class="header-section-number">5.5</span> Test yourself - More exploration of the iris dataset</h2>
<ol type="1">
<li>How many rows does the <code>iris</code> dataset have?</li>
<li>What is the class of each of its columns?</li>
<li>What is the mean sepal length of the flowers?</li>
<li>What is the smallest (minimum) sepal width?</li>
<li>What is the correlation between petal length and petal width?</li>
<li>Is this correlation statistically significant?</li>
<li>(Difficult) How many <code>viriginca</code> flowers are included in the dataset?<br>
</li>
<li>(Difficult) Can you tabulate the <code>species</code> variable?</li>
<li>(Difficult) Can you make a histogram of species with red bars?</li>
</ol>
</section>
<section id="other-packages-for-descriptive-statistics-if-you-have-time" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="other-packages-for-descriptive-statistics-if-you-have-time"><span class="header-section-number">5.6</span> Other packages for descriptive statistics (if you have time)</h2>
<p>(If we have time) <code>Base</code> R does not have good functions for making descriptive tables and graphs. But there are many other <code>packages</code> that have been developed to help with this.</p>
<p>R packages are add ons developed by the R community to add or improve functions. R packages are the great strength of the R system and mean that R can be used to perform almost any data-related task.</p>
<p>In particular the <code>gt</code> system is very good for making tables, and the <code>GGally</code> package has a nice function for making pairs plots. You could install these packages and try them out:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"gtsummary"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_summary</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Can you stratify this table by species? (Check the help)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"GGally"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>GGally<span class="sc">::</span><span class="fu">ggpairs</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare this to the output from the ‘base’ function <code>pairs(iris)</code> or <code>plot(iris)</code>.</p>
</section>
</section>
<section id="tidyverse" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Tidyverse</h1>
<p>So far we haven’t tried to subset or stratify any analysis. Usually we’ll be interested in comparing different parts of the data, or looking at subgroups.</p>
<p>Before we go any further we’re going to install another set of packages. `Base’ R has a few ways to manipulate datasets, but these can get very clunky and you won’t use them much in practice so it’s better to start using add-on packages as soon as possible.</p>
<p>The two major packages of data wrangling functions are <code>data.table</code> and <code>tidyverse</code>.</p>
<p>Tidyverse is more widely used and so this is what we will focus on here. If you become more familiar with R you might want to explore <code>data.table</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>I am only going to teach <code>tidyverse</code> methods because they are the most widely used. See <a href="https://wetlandscapes.com/blog/a-comparison-of-r-dialects/" class="uri">https://wetlandscapes.com/blog/a-comparison-of-r-dialects/</a> for how to use base or data.table to perform the same options.</p>
</div>
</div>
<p>Tidyverse is in fact a large collection of packages. You can see all of the details here <a href="https://www.tidyverse.org/packages/" class="uri">https://www.tidyverse.org/packages/</a>. In this course we will use functions from the following packages:</p>
<ul>
<li><strong>dplyr</strong> for data manipulation</li>
<li><strong>ggplot2</strong> for making graphics</li>
<li><strong>broom</strong> for organising analysis results</li>
</ul>
<p>Check if you have <code>tidyverse</code> installed on the computer you are using. Use the <code>packages</code> pane in the bottom right hand section of the screen and search for <code>tidyverse</code>. If it is installed you will see a corresponding line in the <code>packages</code> pane with the current installed version number.</p>
<p>If you do not have <code>tidyverse</code> installed, then install it now from the menu or by using</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This will install a lot of packages and might take a few minutes.</p>
<p>Once the tidyverse packages are installed you can use all of their functions.</p>
<p>We’ll start by using some of the functions from the <code>dplyr</code> package. <code>dplyr</code> includes functions for data manipulation and summarisation.</p>
<p>See <a href="https://dplyr.tidyverse.org/" class="uri">https://dplyr.tidyverse.org/</a> for more information on the <code>dplyr</code> mains functions, and a cheat sheet for its day-to-day usage.</p>
<section id="using-a-function-from-dplyr" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="using-a-function-from-dplyr"><span class="header-section-number">6.1</span> Using a function from <code>dplyr</code></h2>
<p>There are two ways to use functions installed as part of a package. For example, to use the <code>glimpse</code> function from the <code>dplyr</code> package to look at the <code>iris</code> dataset, you can type:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># or library(tidyverse)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Using <code>library</code> adds the package to the search path for the whole of your R session. This means that R will be able to find all of the functions in this package without explicitly referencing the package every time.</p>
</div>
</div>
</div>
<p>I will load the tidyverse package, which will attach all of the ‘core’ tidyverse packages into my current session:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.0     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
</section>
<section id="using-dplyr-functions-to-manipulate-and-summarise-data" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="using-dplyr-functions-to-manipulate-and-summarise-data"><span class="header-section-number">6.2</span> Using dplyr functions to manipulate and summarise data</h2>
<p>The five main dplyr functions are <code>select</code>, <code>filter</code>, <code>mutate</code>, <code>group_by</code>, and <code>summarise</code>.</p>
<p>Let’s learn by example what each of these functions does:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">select</span>(Sepal.Length, Sepal.Width)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">"setosa"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Sepal.Length <span class="sc">&gt;</span> <span class="fl">7.5</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">arrange</span>(Sepal.Length)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Median Petal Width</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">median</span>(Petal.Width))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="st">`</span><span class="at">Mean</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">median</span>(Petal.Width), <span class="st">`</span><span class="at">SD</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sd</span>(Petal.Width))</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">Sepal.Area =</span> Sepal.Length <span class="sc">*</span> Sepal.Width)</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">logPetalLength =</span> <span class="fu">log</span>(Petal.Length))</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>iris2 <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">PetalLengthGrouped =</span> <span class="fu">ntile</span>(Petal.Length, <span class="dv">5</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So with <code>dplyr</code> we can take subsets of our data or our samples, split our samples up into groups, create new derived variables and make summary statistics.</p>
<p>Using pipes you can chain functions together. Suppose you wanted the mean sepal length of <code>setosa</code> flowers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">"setosa"</span>) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(Sepal.Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>group_by</code> and <code>summarise</code> are often used together, to make summaries over groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(Sepal.Length), <span class="fu">mean</span>(Sepal.Width), <span class="at">n=</span><span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It can be more readable if you write the command above using more than one line:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Species <span class="sc">!=</span> <span class="st">"setosa"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> </span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean sepal length"</span><span class="ot">=</span><span class="fu">mean</span>(Sepal.Length), </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mean sepal width"</span><span class="ot">=</span><span class="fu">mean</span>(Sepal.Width), </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Number of Samples"</span><span class="ot">=</span><span class="fu">n</span>()</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 4
  Species    `Mean sepal length` `Mean sepal width` `Number of Samples`
  &lt;chr&gt;                    &lt;dbl&gt;              &lt;dbl&gt;               &lt;int&gt;
1 versicolor                5.94               2.77                  50
2 virginica                 6.59               2.97                  50</code></pre>
</div>
</div>
<p>Make sure you understand exactly what is happening with each of the commands above. In particular the last line, with <code>filter</code> followed by <code>group_by</code> followed by <code>summarise</code> demonstrates how simple functions can be built into powerful data manipulation and analysis commands.</p>
</section>
<section id="test-yourself-data-wrangling-and-summarising" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="test-yourself-data-wrangling-and-summarising"><span class="header-section-number">6.3</span> Test yourself: data wrangling and summarising</h2>
<p>Can you use dplyr to:</p>
<ol type="1">
<li>Find the mean sepal length</li>
<li>Make a new dataset including only flowers with a petal length less than 2</li>
<li>Find the mean of the sepal length for flowers with a petal length less than 2? (hint: use pipes to chain together the answers from questions 2 and 1.)</li>
<li>Find the median and range for sepal width stratified across species? (hint: pipe together a <code>group_by</code> and a <code>summarise</code> call)</li>
</ol>
</section>
</section>
<section id="graphics" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Graphics</h1>
<p>R has a simple built in system for making graphs but the outputs are not very good!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Petal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="{callout-note}">
<p>Although this <code>boxplot</code> function isn’t very useful, note the <code>~</code> syntax as this is used widely elsewhere. See the ‘formula interface’ section below for more information.</p>
</div>
<p>The ggplot() system is much more flexible, and produces publication quality outputs. <code>ggplot2</code> is a core <code>tidyverse</code> package, so we loaded it earlier. If it isn’t loaded (if R says it can’t find the <code>ggplot</code> function) then use <code>library(ggplot2)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width, <span class="at">color=</span>Species) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using a pipe and multiple lines to improve readability</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>Petal.Length, <span class="at">fill=</span>Species) <span class="sc">+</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We’ll see more ggplot in later sessions, but note the syntax, in particular how a dataset is passed to the ggplot function, how we specify the linkage between the data and the plot, and how different elements are added to make the plot.</p>
</section>
<section id="hypothesis-tests-and-linear-models" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Hypothesis tests and linear models</h1>
<p>Descriptive statistics are important, but our goal in science is often to test hypotheses or understand the mechanisms behind our data generation.</p>
<p>So, we might observe a difference in petal length between species in our sample, but we want to know if this reflects a real difference in average petal length in the population. That is, does petal length depend on species among iris flowers in general?</p>
<p>First, we can generate a simple box plot as previously to explore this question:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Species, <span class="at">y=</span>Petal.Length, <span class="at">fill=</span>Species)) <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Species"</span>, <span class="at">y=</span><span class="st">"Petal Length"</span>) <span class="sc">+</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It looks like the two variables are related, but we would like to perform a hypothesis test to see if the difference is statistically significant, and to get an estimate (with confidence interval) for the difference.</p>
<p>To get the coefficients (mean differences between groups) we can estimate a linear model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When you estimate a model R will not display any output. The results are all stored in the model object that is created. Then you can access whatever output you want using other functions, eg:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R functions</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Species, data = iris)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6880 -0.3285 -0.0060  0.3120  1.3120 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         5.0060     0.0728  68.762  &lt; 2e-16 ***
Speciesversicolor   0.9300     0.1030   9.033 8.77e-16 ***
Speciesvirginica    1.5820     0.1030  15.366  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5148 on 147 degrees of freedom
Multiple R-squared:  0.6187,    Adjusted R-squared:  0.6135 
F-statistic: 119.3 on 2 and 147 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Sepal.Length
           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
Species     2 63.212  31.606  119.26 &lt; 2.2e-16 ***
Residuals 147 38.956   0.265                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      2.5 %   97.5 %
(Intercept)       4.8621258 5.149874
Speciesversicolor 0.7265312 1.133469
Speciesvirginica  1.3785312 1.785469</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A tidyverse method:</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(model1, <span class="at">conf.int=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 7
  term              estimate std.error statistic   p.value conf.low conf.high
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)           5.01    0.0728     68.8  1.13e-113    4.86       5.15
2 Speciesversicolor     0.93    0.103       9.03 8.77e- 16    0.727      1.13
3 Speciesvirginica      1.58    0.103      15.4  2.21e- 32    1.38       1.79</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Functions from the `gtsummary` package if you have it installed</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="ndvxidqvpu" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ndvxidqvpu table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ndvxidqvpu thead, #ndvxidqvpu tbody, #ndvxidqvpu tfoot, #ndvxidqvpu tr, #ndvxidqvpu td, #ndvxidqvpu th {
  border-style: none;
}

#ndvxidqvpu p {
  margin: 0;
  padding: 0;
}

#ndvxidqvpu .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ndvxidqvpu .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ndvxidqvpu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ndvxidqvpu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ndvxidqvpu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ndvxidqvpu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ndvxidqvpu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ndvxidqvpu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ndvxidqvpu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ndvxidqvpu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ndvxidqvpu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ndvxidqvpu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ndvxidqvpu .gt_spanner_row {
  border-bottom-style: hidden;
}

#ndvxidqvpu .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ndvxidqvpu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ndvxidqvpu .gt_from_md > :first-child {
  margin-top: 0;
}

#ndvxidqvpu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ndvxidqvpu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ndvxidqvpu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ndvxidqvpu .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ndvxidqvpu .gt_row_group_first td {
  border-top-width: 2px;
}

#ndvxidqvpu .gt_row_group_first th {
  border-top-width: 2px;
}

#ndvxidqvpu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndvxidqvpu .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ndvxidqvpu .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ndvxidqvpu .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ndvxidqvpu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndvxidqvpu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ndvxidqvpu .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ndvxidqvpu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ndvxidqvpu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ndvxidqvpu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ndvxidqvpu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndvxidqvpu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ndvxidqvpu .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ndvxidqvpu .gt_left {
  text-align: left;
}

#ndvxidqvpu .gt_center {
  text-align: center;
}

#ndvxidqvpu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ndvxidqvpu .gt_font_normal {
  font-weight: normal;
}

#ndvxidqvpu .gt_font_bold {
  font-weight: bold;
}

#ndvxidqvpu .gt_font_italic {
  font-style: italic;
}

#ndvxidqvpu .gt_super {
  font-size: 65%;
}

#ndvxidqvpu .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ndvxidqvpu .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ndvxidqvpu .gt_indent_1 {
  text-indent: 5px;
}

#ndvxidqvpu .gt_indent_2 {
  text-indent: 10px;
}

#ndvxidqvpu .gt_indent_3 {
  text-indent: 15px;
}

#ndvxidqvpu .gt_indent_4 {
  text-indent: 20px;
}

#ndvxidqvpu .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Beta</strong>"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>95% CI</strong><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">Species</td>
<td headers="estimate" class="gt_row gt_center"><br></td>
<td headers="ci" class="gt_row gt_center"><br></td>
<td headers="p.value" class="gt_row gt_center"><br></td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;setosa</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"><br></td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;versicolor</td>
<td headers="estimate" class="gt_row gt_center">0.93</td>
<td headers="ci" class="gt_row gt_center">0.73, 1.1</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">&nbsp;&nbsp;&nbsp;&nbsp;virginica</td>
<td headers="estimate" class="gt_row gt_center">1.6</td>
<td headers="ci" class="gt_row gt_center">1.4, 1.8</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<section id="test-yourself-model-outputs" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="test-yourself-model-outputs"><span class="header-section-number">8.1</span> Test yourself (model outputs)</h2>
<ol type="1">
<li>Can you interpret the model summaries?</li>
<li>Which model output format do you prefer?</li>
<li>Can you estimate the linear model and display the summary in one line using pipes?</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>You can run t-tests using <code>lm</code>, since a t-test is equivalent to a linear model with two group categorical predictor. Linear models generalise many traditional statistical procedures.</p>
<p>The only difference that you might see is that in R, the default t-test is not student’s t-test but Welch’s t-test, which does not assume equal variance between groups. Most of the time these are similar (and you should trust Welch’s test if they are not) but if you don’t see identical results between the <code>lm</code> and <code>t.test</code> functions this is likely the reason.</p>
</div>
</div>
</section>
<section id="further-uses-of-linear-models." class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="further-uses-of-linear-models."><span class="header-section-number">8.2</span> Further uses of linear models.</h2>
<p>Generate all pairwise comparisons using <code>emmeans</code> or t-tests for individual pairs with <code>filter</code> then <code>lm</code>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>emmeans<span class="sc">::</span><span class="fu">emmeans</span>(model1 , pairwise<span class="sc">~</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$emmeans
 Species    emmean     SE  df lower.CL upper.CL
 setosa       5.01 0.0728 147     4.86     5.15
 versicolor   5.94 0.0728 147     5.79     6.08
 virginica    6.59 0.0728 147     6.44     6.73

Confidence level used: 0.95 

$contrasts
 contrast               estimate    SE  df t.ratio p.value
 setosa - versicolor      -0.930 0.103 147  -9.033  &lt;.0001
 setosa - virginica       -1.582 0.103 147 -15.366  &lt;.0001
 versicolor - virginica   -0.652 0.103 147  -6.333  &lt;.0001

P value adjustment: tukey method for comparing a family of 3 estimates </code></pre>
</div>
</div>
<p>You can get many different contrasts or test different hypothesis based on this model using the <code>marginaleffects</code> package.</p>
<p>Model diagnostics with the <code>performance</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(model1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="more-complex-models-interactions-and-multiple-regression" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="more-complex-models-interactions-and-multiple-regression"><span class="header-section-number">8.3</span> More complex models (interactions and multiple regression)</h2>
<p>Suppose we want to fit a more complex model, whereby sepal length depends on petal length, with the relationship allowed to vary by species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First make a model with Sepal.Length depending on Species and Petal.Length</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species <span class="sc">+</span> Petal.Length, <span class="at">data=</span>iris)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Species + Petal.Length, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.75310 -0.23142 -0.00081  0.23085  1.03100 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        3.68353    0.10610  34.719  &lt; 2e-16 ***
Speciesversicolor -1.60097    0.19347  -8.275 7.37e-14 ***
Speciesvirginica  -2.11767    0.27346  -7.744 1.48e-12 ***
Petal.Length       0.90456    0.06479  13.962  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.338 on 146 degrees of freedom
Multiple R-squared:  0.8367,    Adjusted R-squared:  0.8334 
F-statistic: 249.4 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now add the interaction term.  These two models are the same.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species <span class="sc">+</span> Petal.Length <span class="sc">+</span> Species<span class="sc">:</span>Petal.Length, <span class="at">data=</span>iris)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species <span class="sc">*</span> Petal.Length, <span class="at">data=</span>iris)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sepal.Length ~ Species * Petal.Length, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.73479 -0.22785 -0.03132  0.24375  0.93608 

Coefficients:
                               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                      4.2132     0.4074  10.341  &lt; 2e-16 ***
Speciesversicolor               -1.8056     0.5984  -3.017  0.00302 ** 
Speciesvirginica                -3.1535     0.6341  -4.973 1.85e-06 ***
Petal.Length                     0.5423     0.2768   1.959  0.05200 .  
Speciesversicolor:Petal.Length   0.2860     0.2951   0.969  0.33405    
Speciesvirginica:Petal.Length    0.4534     0.2901   1.563  0.12029    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3365 on 144 degrees of freedom
Multiple R-squared:  0.8405,    Adjusted R-squared:  0.8349 
F-statistic: 151.7 on 5 and 144 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We can use <code>augment</code> from the <code>broom</code> package to add predicted values to our dataset, with confidence intervals.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look carefully at the output from here:</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>model3 <span class="sc">|&gt;</span> <span class="fu">augment</span>(<span class="at">interval=</span><span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 11
   Sepal.Length Species Petal.Length .fitted .lower .upper  .resid   .hat .sigma
          &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1          5.1 setosa           1.4    4.97   4.87   5.07  0.128  0.0226  0.337
 2          4.9 setosa           1.4    4.97   4.87   5.07 -0.0724 0.0226  0.338
 3          4.7 setosa           1.3    4.92   4.79   5.05 -0.218  0.0378  0.337
 4          4.6 setosa           1.5    5.03   4.93   5.12 -0.427  0.0210  0.336
 5          5   setosa           1.4    4.97   4.87   5.07  0.0276 0.0226  0.338
 6          5.4 setosa           1.7    5.14   4.97   5.30  0.265  0.0583  0.337
 7          4.6 setosa           1.4    4.97   4.87   5.07 -0.372  0.0226  0.336
 8          5   setosa           1.5    5.03   4.93   5.12 -0.0266 0.0210  0.338
 9          4.4 setosa           1.4    4.97   4.87   5.07 -0.572  0.0226  0.334
10          4.9 setosa           1.5    5.03   4.93   5.12 -0.127  0.0210  0.337
# ℹ 140 more rows
# ℹ 2 more variables: .cooksd &lt;dbl&gt;, .std.resid &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Finally we can use ggplot to show these predicted values and confidence intervals. Take care to understand how the output from each function (ie <code>lm</code>, <code>augment</code>) is piped into the next.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( Sepal.Length <span class="sc">~</span> Species <span class="sc">*</span> Petal.Length, <span class="at">data=</span>iris) <span class="sc">|&gt;</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>(<span class="at">interval=</span><span class="st">"confidence"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>Petal.Length, <span class="at">y=</span>Sepal.Length, <span class="at">color=</span>Species) <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted,<span class="at">ymin=</span>.lower, <span class="at">ymax=</span>.upper), <span class="at">alpha=</span><span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>.fitted),<span class="at">lwd=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day1_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Try changing the forumula to `Sepal.Length ~ Species + Petal.Length`</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Which model has the better fit? (you can use anova(model2, model3) to compare models)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="extra-material-below-here" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Extra material below here</h1>
<p>Below this point is extra material that was cut from the main day 1 tutorial but I’ve kept in this document because it might be interesting. There are likely to be a few small mistakes in this section.</p>
<section id="more-detail-on-types-and-classes" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="more-detail-on-types-and-classes"><span class="header-section-number">9.1</span> More detail on types and classes</h2>
<p>We saw two object of two different ‘classes’ earlier. These classes were ‘numeric’ and ‘character’. The class of an object defines what kind of information it holds, and how other functions act on it.</p>
<p>There are four basic classes (modes) that you will commonly use and should be aware of. These correspond to the types of data you might have. The basic types are:</p>
<ul>
<li>‘numeric’ – For keeping numbers, can be discrete or continuous</li>
<li>‘logical’ – can only take the values (TRUE or FALSE)</li>
<li>‘character’ – for strings of text</li>
<li>‘factor’ – for labelled categorical variables (ordered or unordered)</li>
</ul>
<p>Later in this tutorial we will see objects of more complex classes, these can store lots of different information of different modes:</p>
<ul>
<li>‘data.frame’ – storing datasets</li>
<li>‘lm’ – stores the all results of a linear regression model</li>
</ul>
</section>
<section id="character-strings" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="character-strings"><span class="header-section-number">9.2</span> Character strings</h2>
<p>Character strings represent text rather than numbers. Strings are used to label categories in a dataset, to identify columns in a dataset, to make your outputs more readable. You also might find that part of your data has been entered as a string, for example patient identifiers or gene names in a database, or responses to open ended questions.</p>
<p>Strings are identified in R (and in most other programming languages) by enclosing them in quotes. Single quotes and double quotes can be used (and are treated almost identically), but double quotes are preferred. For example try:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Hello"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'Hello'</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="co"># What happens here?</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Hello)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A common mistake in R is to forget to enclose strings in quotes. In which case R tries to interpret your input as an object name, leading to an error message if that name doesn’t exist.</p>
</section>
<section id="logicals" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="logicals"><span class="header-section-number">9.3</span> Logicals</h2>
<p>Logicals represent binary information in the form <code>TRUE</code> or <code>FALSE</code>. They most often arise as the result of a comparison, for example try:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="sc">&gt;</span><span class="dv">2</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="st">"Hello"</span> <span class="sc">==</span> <span class="st">"hello"</span>  <span class="co"># note the double equals sign, this distinguishes assignment from comparison</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="converting-between-types" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="converting-between-types"><span class="header-section-number">9.4</span> Converting between types</h2>
<p>Sometimes it is possible to convert an object from one class to another. For example, a number might be stored as a character string in your data, and you will need to convert it into a numeric before you can do any analysis with it. For example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">"3"</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>x<span class="sc">*</span><span class="dv">2</span> <span class="co"># What is the error message here?  What does it mean?</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x)</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>y<span class="sc">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="missing-elements-in-vectors" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="missing-elements-in-vectors"><span class="header-section-number">9.5</span> Missing elements in vectors</h2>
<p>Often your data will include missing values. R uses <code>NA</code> to represent missing values. For example the following creates a vector (a single variable, like a single column of a data frame) with a missing value in the fourth position:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">21</span>,<span class="dv">32</span>,<span class="cn">NA</span>,<span class="dv">14</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note the difference between <code>NA</code> (a missing value) and <code>"NA"</code> (a character string containing the letters N and A. I have been tripped up by this a few times when <code>"NA"</code> has been entered into a dataset.)</p>
</div>
</div>
</section>
<section id="exercise-1.-effect-of-missing-values" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="exercise-1.-effect-of-missing-values"><span class="header-section-number">9.6</span> Exercise 1. Effect of missing values</h2>
<p>Try some other functions with myvector to see what impact the missing data point has.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(weights)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weights)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>weights<span class="sc">&gt;</span><span class="dv">20</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(weights) <span class="co"># what happens here?  Why?  Can you fix it?</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">is.na</span>(weights) <span class="co"># what does this do?</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(weights)) <span class="co"># can you explain what this does?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The behaviour of R functions with missing data can vary. Some functions will not work, some will return <code>NA</code> but some will just exclude the missing elements and carry on. If you have missing data it is important to understand how the R functions you are using will handle it.</p>
</section>
</section>
<section id="more-descriptive-statistics" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> More descriptive statistics</h1>
<p>In this rest of this session we’ll use base and tidyverse functions to complete some common descriptive and analytic tasks using the iris dataset.</p>
<section id="a-continuous-variable-stratified-by-a-grouping-variable-and-the-formula-interface" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="a-continuous-variable-stratified-by-a-grouping-variable-and-the-formula-interface"><span class="header-section-number">10.1</span> A continuous variable stratified by a grouping variable, and the formula interface</h2>
<p>We already saw a way to get means over a categorical variable with <code>tidyverse</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">mean</span>(Sepal.Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we want more than one summary statistic for example, it’s easy with tidyverse (this is an example of a task that is difficult with base R):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> <span class="fu">summarise</span>(<span class="fu">n</span>(),<span class="fu">mean</span>(Sepal.Length),<span class="fu">sd</span>(Sepal.Length))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note here that we can write the call in more than one line to make it easier to read:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">n</span>(),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mean</span>(Sepal.Length),</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sd</span>(Sepal.Length)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  Species    `n()` `mean(Sepal.Length)` `sd(Sepal.Length)`
  &lt;chr&gt;      &lt;int&gt;                &lt;dbl&gt;              &lt;dbl&gt;
1 setosa        50                 5.01              0.352
2 versicolor    50                 5.94              0.516
3 virginica     50                 6.59              0.636</code></pre>
</div>
</div>
<p>dplyr is good for making summary statistics, but to make publication ready tables you can explore the <code>gtsummary</code> package.</p>
<p><a href="https://www.danieldsjoberg.com/gtsummary/articles/tbl_summary.html" class="uri">https://www.danieldsjoberg.com/gtsummary/articles/tbl_summary.html</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gtsummary' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">tbl_summary</span>( <span class="at">by=</span>Species )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="odhvcdacsg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#odhvcdacsg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#odhvcdacsg thead, #odhvcdacsg tbody, #odhvcdacsg tfoot, #odhvcdacsg tr, #odhvcdacsg td, #odhvcdacsg th {
  border-style: none;
}

#odhvcdacsg p {
  margin: 0;
  padding: 0;
}

#odhvcdacsg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#odhvcdacsg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#odhvcdacsg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#odhvcdacsg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#odhvcdacsg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#odhvcdacsg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#odhvcdacsg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#odhvcdacsg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#odhvcdacsg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#odhvcdacsg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#odhvcdacsg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#odhvcdacsg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#odhvcdacsg .gt_spanner_row {
  border-bottom-style: hidden;
}

#odhvcdacsg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#odhvcdacsg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#odhvcdacsg .gt_from_md > :first-child {
  margin-top: 0;
}

#odhvcdacsg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#odhvcdacsg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#odhvcdacsg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#odhvcdacsg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#odhvcdacsg .gt_row_group_first td {
  border-top-width: 2px;
}

#odhvcdacsg .gt_row_group_first th {
  border-top-width: 2px;
}

#odhvcdacsg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#odhvcdacsg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#odhvcdacsg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#odhvcdacsg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#odhvcdacsg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#odhvcdacsg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#odhvcdacsg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#odhvcdacsg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#odhvcdacsg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#odhvcdacsg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#odhvcdacsg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#odhvcdacsg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#odhvcdacsg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#odhvcdacsg .gt_left {
  text-align: left;
}

#odhvcdacsg .gt_center {
  text-align: center;
}

#odhvcdacsg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#odhvcdacsg .gt_font_normal {
  font-weight: normal;
}

#odhvcdacsg .gt_font_bold {
  font-weight: bold;
}

#odhvcdacsg .gt_font_italic {
  font-style: italic;
}

#odhvcdacsg .gt_super {
  font-size: 65%;
}

#odhvcdacsg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#odhvcdacsg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#odhvcdacsg .gt_indent_1 {
  text-indent: 5px;
}

#odhvcdacsg .gt_indent_2 {
  text-indent: 10px;
}

#odhvcdacsg .gt_indent_3 {
  text-indent: 15px;
}

#odhvcdacsg .gt_indent_4 {
  text-indent: 20px;
}

#odhvcdacsg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>setosa</strong>, N = 50<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>setosa</strong>, N = 50<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>versicolor</strong>, N = 50<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>versicolor</strong>, N = 50<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>virginica</strong>, N = 50<span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;><sup>1</sup></span>"><strong>virginica</strong>, N = 50<span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">X</td>
<td headers="stat_1" class="gt_row gt_center">26 (13, 38)</td>
<td headers="stat_2" class="gt_row gt_center">76 (63, 88)</td>
<td headers="stat_3" class="gt_row gt_center">126 (113, 138)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Sepal.Length</td>
<td headers="stat_1" class="gt_row gt_center">5.00 (4.80, 5.20)</td>
<td headers="stat_2" class="gt_row gt_center">5.90 (5.60, 6.30)</td>
<td headers="stat_3" class="gt_row gt_center">6.50 (6.23, 6.90)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Sepal.Width</td>
<td headers="stat_1" class="gt_row gt_center">3.40 (3.20, 3.68)</td>
<td headers="stat_2" class="gt_row gt_center">2.80 (2.53, 3.00)</td>
<td headers="stat_3" class="gt_row gt_center">3.00 (2.80, 3.18)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Petal.Length</td>
<td headers="stat_1" class="gt_row gt_center">1.50 (1.40, 1.58)</td>
<td headers="stat_2" class="gt_row gt_center">4.35 (4.00, 4.60)</td>
<td headers="stat_3" class="gt_row gt_center">5.55 (5.10, 5.88)</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Petal.Width</td>
<td headers="stat_1" class="gt_row gt_center">0.20 (0.20, 0.30)</td>
<td headers="stat_2" class="gt_row gt_center">1.30 (1.20, 1.50)</td>
<td headers="stat_3" class="gt_row gt_center">2.00 (1.80, 2.30)</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><span class="gt_footnote_marks" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>1</sup></span> Median (IQR)</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
</section>
<section id="recoding-a-variable-into-groups" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="recoding-a-variable-into-groups"><span class="header-section-number">10.2</span> Recoding a variable into groups</h2>
<p>Suppose we want to classify flowers into three groups based on their petal length. We need to add another categorical variable to the dataset.</p>
<p>What class should that new variable be?</p>
<p>Base R has the function <code>cut</code> that divides continuous variables into groups. Tidyverse has a few extensions of this (weirdly in the ggplot2 package), including <code>cut_number</code> that can divide up a continuous variable into three equal groups, and allow us to add labels to them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cut_number</span>(iris<span class="sc">$</span>Petal.Length, <span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Short"</span>, <span class="st">"Medium"</span>, <span class="st">"Long"</span>) )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using tidyverse to create this variable and add it to the dataset:</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">PetalLengthGrouped =</span> <span class="fu">cut_number</span>(Petal.Length, <span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Short"</span>, <span class="st">"Medium"</span>, <span class="st">"Long"</span>) )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although it can be useful descriptively, it is sometimes a very bad idea to group up your variables like this. See <a href="./dichot.html">Don’t dichotomise your data</a> for an explanation.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>