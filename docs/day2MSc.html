<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="George Savva, QIB">
<meta name="author" content="Pirita Paajanen, JIC">
<meta name="dcterms.date" content="2023-10-01">

<title>R for Statistics - Intro to R for statistics, Day 2 (MSc version)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">R for Statistics</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target=""><i class="bi bi-fa-home" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-intro-to-r-for-statistics" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Intro to R for Statistics</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-intro-to-r-for-statistics">    
        <li>
    <a class="dropdown-item" href="./day1.html" rel="" target="">
 <span class="dropdown-text">NBI PhD Intro to R Day 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./day2.html" rel="" target="">
 <span class="dropdown-text">Day 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./day3.html" rel="" target="">
 <span class="dropdown-text">Day 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./workshopscript.html" rel="" target="">
 <span class="dropdown-text">JIC MSc Workshop (2021/2022)</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./flipbook.html" rel="" target="">
 <span class="dropdown-text">ggplot example</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-statistics-notes" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Statistics notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-statistics-notes">    
        <li>
    <a class="dropdown-item" href="./dichot.html" rel="" target="">
 <span class="dropdown-text">Don’t group your data points</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./alphabeta.html" rel="" target="">
 <span class="dropdown-text">Simple alpha and beta diversity simulation</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./berkson.html" rel="" target="">
 <span class="dropdown-text">Selection bias (Berkson bias) in observational studies</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./independentclusters.html" rel="" target="">
 <span class="dropdown-text">Sampling from clustered data in observational studies</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="mailto:george.savva@quadram.ac.uk" rel="" target=""><i class="bi bi-fa-envelope-o" role="img">
</i> 
 <span class="menu-text">Contact me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/georgemsavva" rel="" target=""><i class="bi bi-fa-github" role="img">
</i> 
 <span class="menu-text">GitHub</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#using-readxl-to-read-data-from-excel-files" id="toc-using-readxl-to-read-data-from-excel-files" class="nav-link active" data-scroll-target="#using-readxl-to-read-data-from-excel-files">Using <code>readxl</code> to read data from Excel files</a></li>
  <li><a href="#cleaning" id="toc-cleaning" class="nav-link" data-scroll-target="#cleaning">Cleaning</a></li>
  <li><a href="#analysis---exercises" id="toc-analysis---exercises" class="nav-link" data-scroll-target="#analysis---exercises">Analysis - Exercises</a></li>
  <li><a href="#solutions" id="toc-solutions" class="nav-link" data-scroll-target="#solutions">Solutions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Intro to R for statistics, Day 2 (MSc version)</h1>
<p class="subtitle lead">Loading, cleaning and plotting data</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>George Savva, QIB </p>
             <p>Pirita Paajanen, JIC </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 1, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>Today’s worksheet introduces you to a real dataset.</p>
<p>The tasks you will cover are:</p>
<ul>
<li>reading data into R from an Excel file</li>
<li>checking and cleaning the data</li>
<li>revision of some of statistics and graphing that we covered on the first day.</li>
</ul>
<section id="the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="the-dataset">The dataset</h2>
<p>The data are from a randomised clinical trial of a new rehabilition intervention (compared to standard post-stroke care) aimed at improving the walking speed of hospital patients. Better walking speed is a good indicator of general stroke recovery.</p>
<p>We have recorded:</p>
<ul>
<li>The age and sex of each participant,</li>
<li>The treatment allocation,</li>
<li>The hospital department from which they were recruited and</li>
<li>Time they take to complete a walking task.</li>
</ul>
<p>Our research questions are:</p>
<ul>
<li>Does the treatment improve walking speed compared to controls?</li>
<li>By how much does it improve, and how certain are we of this?</li>
</ul>
<p>The dataset can be found at <a href="./walkingspeed_day2.xlsx">walkingspeed_day2.xlsx</a></p>
<ul>
<li>Powerpoint slides to support this material are at:</li>
</ul>
<p><a href="./day3.pptx">day3.pptx</a></p>
<p>Our workflow is:</p>
<ol type="1">
<li>Clean and code</li>
<li>Visualise</li>
<li>Describe</li>
<li>Model</li>
<li>Diagnose model</li>
<li>Interpret</li>
</ol>
</section>
<section id="using-readxl-to-read-data-from-excel-files" class="level1">
<h1>Using <code>readxl</code> to read data from Excel files</h1>
<p>R is not used for data entry or storage; you are likely to have data stored as an Excel file, a csv file, in a database, or in some other format generated by a device.</p>
<p>So before we can do any analysis we need to import data. We do this in code like everything else in R.</p>
<p>Do read Excel files we use the package called <code>readxl</code>. If you already installed <code>tidyverse</code> then you already have this package.</p>
<p>Once the library is installed we can use the function <code>readxl::read_excel()</code>, which reads data from an excel file.</p>
<section id="make-sure-the-data-looks-ok-and-is-in-the-right-place-on-your-computer" class="level2">
<h2 class="anchored" data-anchor-id="make-sure-the-data-looks-ok-and-is-in-the-right-place-on-your-computer">Make sure the data looks OK and is in the right place on your computer</h2>
<p>Before we dive in and import it, we need to make sure our data is in a sensible place.</p>
<ol type="1">
<li><p>Open RStudio and open the project you created in day 1 (if not already opened).</p></li>
<li><p>Then, save the example data <a href="`walkingspeed_msc.xlsx`"><code>walkingspeed_msc.xlsx</code></a> for this tutorial into your project folder. Check that it has appeared in the ‘files’ pane in RStudio.</p></li>
<li><p>Start a new script file that will eventually include all of the commands we need to import, clean, visualise and analyse the data.</p></li>
<li><p>Now open the dataset in Excel and explore the file so that you understand what is there.</p></li>
</ol>
</section>
<section id="read-the-help" class="level2">
<h2 class="anchored" data-anchor-id="read-the-help">Read the help!</h2>
<p>We are nearly ready to import our data. But remember that before using a new function its always good to read its documentation. The <code>read_excel()</code> function has a few different options so first we should look at the help file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>?read_excel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note from the help file that <code>read_excel()</code> can extract data from different sheets and ranges of an Excel workbook, can use or ignore column names, and allows you to specify the type of data (numeric, dates, text etc) if you want to, or leave it to R to guess.</p>
<p>Many R packages also have vignettes or websites including simpler guides to their use in specific cases. <code>readxl</code> has a website that you might find helpful: <a href="https://readxl.tidyverse.org/">https://readxl.tidyverse.org/</a></p>
<p>Now we’ll load the data. We want to use the ‘walking speed’ data from the <code>walkingspeed_msc.xlsx</code> spreadsheet.</p>
<ul>
<li>Open the spreadsheet in Excel and find this sheet. The data we want is in the sheet called ‘day2’.</li>
</ul>
<p>From the <code>read_excel()</code> help file we can deduce the syntax to load this data into R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readxl' was built under R version 4.2.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="at">path=</span><span class="st">"walkingspeed_msc.xlsx"</span>, <span class="at">sheet=</span><span class="st">"day2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This line assumes that the file <code>walkingspeed_msc.xlsx</code> is in the current working directory (you can check what this is with <code>getwd()</code>). The current working directory is shown just above the R console window. You can see the files in the current working directory in the ‘Files’ tab on the bottom right of the RStudio window. When you create or load a project RStudio will set the working directory to the root of the project directory.</p>
<p>This line calls the <code>read_excel()</code> function, with the arguments <code>path</code>, <code>sheet</code> set. The other arguments will be set to their default values, which you can see from the help file.</p>
<p>We could have set the range of the data in the spreadsheet (I usually do this for safety), but <code>read_excel()</code> can figure it out automatically most of the time; by default it picks the biggest continuous chunk of data starting in the top left of the sheet.</p>
<p>Now you should have a ‘data frame’ object called <code>walkingdat</code> in your environment, which includes the data from the Excel sheet ready to process and analyse.</p>
</section>
</section>
<section id="cleaning" class="level1">
<h1>Cleaning</h1>
<p>Before we can analyse our data we should check each variable to make sure that it looks OK.</p>
<p>We’ll use functions from day 1 to explore the content and structure of the dataset, and the distributions of the main variables. We can then address any problems that we find.</p>
<p>Recall these functions from the day 1 notes. We are checking that the variables have the correct type, and the distributions of the categorical variables.</p>
<p>This is an important aspect of any data analysis and we must not skip this step.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggplot2' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lubridate' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.3     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [135 × 6] (S3: tbl_df/tbl/data.frame)
 $ patid     : num [1:135] 1 2 3 4 5 6 7 8 9 10 ...
 $ group     : chr [1:135] "treat" "control" "treat" "control" ...
 $ time      : num [1:135] 1.9 3.54 2.93 1.82 2.2 ...
 $ sex       : chr [1:135] "M" "M" "M" "M" ...
 $ age       : chr [1:135] "Don't know" "61" "65" "48" ...
 $ department: num [1:135] 3 3 1 2 2 4 2 4 3 2 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     patid           group                time             sex           
 Min.   :  1.00   Length:135         Min.   :  0.000   Length:135        
 1st Qu.: 34.50   Class :character   1st Qu.:  2.167   Class :character  
 Median : 68.00   Mode  :character   Median :  2.426   Mode  :character  
 Mean   : 68.01                      Mean   :  4.175                     
 3rd Qu.:101.50                      3rd Qu.:  2.949                     
 Max.   :136.00                      Max.   :185.362                     
     age              department   
 Length:135         Min.   :1.000  
 Class :character   1st Qu.:2.000  
 Mode  :character   Median :3.000  
                    Mean   :2.607  
                    3rd Qu.:3.500  
                    Max.   :4.000  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(walkingdat<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(walkingdat<span class="sc">$</span>group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
control   treat 
     68      67 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(walkingdat<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  F   M 
 35 100 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(walkingdat<span class="sc">$</span>department)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1  2  3  4 
28 31 42 34 </code></pre>
</div>
</div>
<p>You will have noticed that one of the numerical variables, age, has been loaded as character variable and not a numeric.</p>
<p>We cannot do anaysis with a character variable!</p>
<p>Why do you think the variable is imported as character and not numeric?</p>
<p>We can convert age to a numeric using <code>as.numeric</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidyverse version:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="ot">&lt;-</span> walkingdat <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `age = as.numeric(age)`.
Caused by warning:
! NAs introduced by coercion</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Base R version:</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>walkingdat<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(walkingdat<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What warning message did you get when you converted this variable? What does it mean?</p>
<p>How might we check on the age and time variables to see if the distribution looks OK?</p>
<p>Can you remember the code to make descriptive statistics and basic plots?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(walkingdat<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(walkingdat<span class="sc">$</span>time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(walkingdat<span class="sc">$</span>age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47 72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(walkingdat<span class="sc">$</span>time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]   0.000 185.362</code></pre>
</div>
</div>
<section id="dealing-with-outliers" class="level2">
<h2 class="anchored" data-anchor-id="dealing-with-outliers">Dealing with outliers</h2>
<p>It looks like there are some unreasonably high and low values of walking time.</p>
<p>We can make another graph of walking speed against age, this time on a logarithmic scale so both the extreme high and extreme low points are visible, to see what is going on.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## base R version</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(walkingdat<span class="sc">$</span>age, walkingdat<span class="sc">$</span>time, <span class="at">log=</span><span class="st">"y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in xy.coords(x, y, xlabel, ylabel, log): 1 y value &lt;= 0 omitted from
logarithmic plot</code></pre>
</div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ggplot2 version</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> walkingdat) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>time) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">scale_y_log10</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Transformation introduced infinite values in continuous y-axis</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It seems there are some values for time that are likely to be technical errors. We can remove these values (set them to missing) in a few different ways:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## base R method to replace the values with NA ('missing')</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>walkingdat<span class="sc">$</span>time[walkingdat<span class="sc">$</span>time<span class="sc">&lt;</span><span class="fl">0.1</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>walkingdat<span class="sc">$</span>time[walkingdat<span class="sc">$</span>time<span class="sc">&gt;</span><span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Using filter we could remove those datapoints</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="ot">&lt;-</span> walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>(time <span class="sc">&lt;</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> <span class="fu">filter</span>(time <span class="sc">&gt;</span> <span class="fl">0.1</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now check the distribution of time again.</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(walkingdat<span class="sc">$</span>time, <span class="at">breaks=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(walkingdat<span class="sc">$</span>time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1.435 17.641</code></pre>
</div>
</div>
<p>Now we have a cleaned dataset in our environment we can proceed with our visualisation and analysis:</p>
</section>
</section>
<section id="analysis---exercises" class="level1">
<h1>Analysis - Exercises</h1>
<p>Add commands to your script file to answer the following questions. Add comments (lines beginning with <code>#</code> to help you remember what you did and why!).</p>
<p>Some solutions are posted at the bottom of the page, but it will help you a lot to try to answer them on your own, by discussing with colleagues, or by looking up help online before using the solutions.</p>
<p>If you don’t understand the given solution, then please ask and we can go through it in the class.</p>
<p>We will discuss the testing, modelling and graphing elements in more detail on day 3, but it would be helpful to attempt these today.</p>
<ol type="1">
<li>Structure of the dataset
<ol type="a">
<li>What are the names of the variables that comprise the <code>walkingdata</code> dataframe?</li>
<li>What is the class of each?</li>
<li>How many columns and rows does it have?</li>
</ol></li>
<li>Descriptive statistics
<ol type="a">
<li>What is the age of youngest patient?</li>
<li>What is the age of the oldest patient?</li>
<li>Are the oldest and youngest patient male or female?</li>
</ol></li>
<li>Cross-tabulation
<ol type="a">
<li>How many Male and Female patients are there?</li>
<li>Is the sex ratio balanced between treatment groups?</li>
<li>How many women are there of age under 50? How many men are there of age under 50?</li>
</ol></li>
<li>Descriptive statistics using a subset of the data
<ol type="a">
<li>What is the average walking speed for men between 50 and 60 years of age?</li>
</ol></li>
<li>Deriving new variables
<ol type="a">
<li>Create a new column that will have the speed of walking, that is 1/time.</li>
<li>Create a new column that will have the time rounded up to nearest 10th of a second.</li>
</ol></li>
</ol>
<section id="graphics" class="level2">
<h2 class="anchored" data-anchor-id="graphics">Graphics</h2>
<ol type="1">
<li>Graphing
<ol type="a">
<li>Consider what kind of graph you might make to illustrate the difference in walking speed between treatment groups, and try to make it using ggplot. Eg:</li>
<li>Make a box plot of time by sex, with a different coloured box per sex</li>
<li>Label the axes appropriately</li>
<li>Try a violin plot instead of a boxplot (with geom_violin). Which do you prefer?</li>
<li>Make any other adjustments you think are informative!</li>
</ol></li>
</ol>
</section>
<section id="modelling" class="level2">
<h2 class="anchored" data-anchor-id="modelling">Modelling</h2>
<p>I have left these sections in from the PhD workshop. Attempt them if you get time.</p>
<ol type="1">
<li>Hypothesis Testing
<ol type="a">
<li>What is the difference in average walking speed between control patients and treated patients?</li>
<li>Is this difference statistically significant? Use t-test <code>t.test()</code> and Mann-Whitney tests <code>wilcox.test()</code> to examine the differences between the groups. Look up the syntax for <code>t.test()</code> and <code>wilcox.test()</code> using the help system, and use them to check whether the time taken to complete the task varies by treatment status. In each case use the version of the function that takes a <code>formula</code> agument. Remember the <code>formula</code> syntax from the <code>boxplot</code> and <code>lm</code> functions in day 1.</li>
<li>Compare the p-values for each method.</li>
<li>Consider the assumptions for a t-test, and whether they are met in this dataset.<br>
</li>
<li>Do you believe that treatment affects walking speed?</li>
</ol></li>
<li>Linear model diagnostics
<ol type="a">
<li>Estimate a linear model (with <code>lm</code>) to estimate/test the effect of treatment on task completion time.</li>
<li>Use <code>summary</code> to get the model coefficients and p-values</li>
<li>Use <code>broom::tidy</code> to get the model coefficients and p-values</li>
<li>Compare the model results to the equivalent t-test</li>
<li>Extend the model to include the effects of age and sex as potential covariates.</li>
<li>Use <code>plot()</code> to explore the model diagnostics</li>
<li>Use <code>performance::check_model()</code> to explore the model diagnostics</li>
<li>Now estimate a new model to compare the task completion speed between groups.</li>
<li>Get the model coefficients and p-values</li>
<li>Check the model diagnostics using <code>plot</code> or <code>performance::check_model</code></li>
<li>Why are the result from this model different? How do you interpret the results?</li>
<li>Can you get the confidence intervals for the treatment effect (use the help for <code>broom::tidy</code>)</li>
<li>Use <code>model_summary</code> package to make a pretty model summary table</li>
</ol></li>
</ol>
</section>
</section>
<section id="solutions" class="level1">
<h1>Solutions</h1>
<p>The exercises will have many possible solutions, under each exercise we have listed a few possible answers. Most are possible using the functions we have introduced in day 1 of the course, or with functions I suggest in the questions, but in some cases there are other solutions that I have given using different functions/packages.</p>
<p>If you answered the questions another way then that’s fine, but do try to understand how the given solutions work.</p>
<section id="structure-of-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="structure-of-the-dataset">Structure of the dataset</h3>
<p><em>What are the names of the variables that comprise the <code>walkingdat</code> dataframe?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Eg</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [132 × 6] (S3: tbl_df/tbl/data.frame)
 $ patid     : num [1:132] 1 2 3 4 5 6 7 8 9 10 ...
 $ group     : chr [1:132] "treat" "control" "treat" "control" ...
 $ time      : num [1:132] 1.9 3.54 2.93 1.82 2.2 ...
 $ sex       : chr [1:132] "M" "M" "M" "M" ...
 $ age       : num [1:132] NA 61 65 48 62 62 57 57 57 55 ...
 $ department: num [1:132] 3 3 1 2 2 4 2 4 3 2 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "patid"      "group"      "time"       "sex"        "age"       
[6] "department"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     patid           group                time            sex           
 Min.   :  1.00   Length:132         Min.   : 1.435   Length:132        
 1st Qu.: 35.75   Class :character   1st Qu.: 2.169   Class :character  
 Median : 69.50   Mode  :character   Median : 2.428   Mode  :character  
 Mean   : 68.82                      Mean   : 2.866                     
 3rd Qu.:102.25                      3rd Qu.: 2.944                     
 Max.   :136.00                      Max.   :17.641                     
                                                                        
      age          department   
 Min.   :47.00   Min.   :1.000  
 1st Qu.:54.00   1st Qu.:2.000  
 Median :57.00   Median :3.000  
 Mean   :57.69   Mean   :2.583  
 3rd Qu.:60.50   3rd Qu.:3.000  
 Max.   :72.00   Max.   :4.000  
 NA's   :1                      </code></pre>
</div>
</div>
<p><em>What is the class of each? What is the class of <code>walkingdat</code>?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [132 × 6] (S3: tbl_df/tbl/data.frame)
 $ patid     : num [1:132] 1 2 3 4 5 6 7 8 9 10 ...
 $ group     : chr [1:132] "treat" "control" "treat" "control" ...
 $ time      : num [1:132] 1.9 3.54 2.93 1.82 2.2 ...
 $ sex       : chr [1:132] "M" "M" "M" "M" ...
 $ age       : num [1:132] NA 61 65 48 62 62 57 57 57 55 ...
 $ department: num [1:132] 3 3 1 2 2 4 2 4 3 2 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(walkingdat, class)  <span class="co">#  'lapply' takes a list (first argument) and applies a function (second argument) to every element of that list.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$patid
[1] "numeric"

$group
[1] "character"

$time
[1] "numeric"

$sex
[1] "character"

$age
[1] "numeric"

$department
[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">map</span>(class) <span class="co"># map is the tidyverse version of lapply.  It is in the 'purrr' package which is loaded when you library(tidyverse).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$patid
[1] "numeric"

$group
[1] "character"

$time
[1] "numeric"

$sex
[1] "character"

$age
[1] "numeric"

$department
[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(walkingdat) <span class="co"># walkingdat is a dataframe, but it is also a `tbl` which is a datframe with a few tidyverse enhancements.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
<ol>
<li>How many columns and rows does <code>walkingdat</code> have?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(walkingdat) <span class="co"># Get the dimension</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 132   6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(walkingdat) <span class="co"># Get the number of rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 132</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(walkingdat) <span class="co"># The 'length' of a data frame is the numve</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive statistics</h3>
<p><em>What is the age of youngest patient?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># look at the help for what na.rm does.  You'll see many of the summary statistics need this.</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(walkingdat<span class="sc">$</span>age, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">min</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `min(age, na.rm = TRUE)`
                     &lt;dbl&gt;
1                       47</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">select</span>(age) <span class="sc">|&gt;</span> <span class="fu">min</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47</code></pre>
</div>
</div>
<p><em>What is the age of the oldest patient?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(walkingdat<span class="sc">$</span>age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">max</span>(age, <span class="at">na.rm=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `max(age, na.rm = TRUE)`
                     &lt;dbl&gt;
1                       72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">select</span>(age) <span class="sc">|&gt;</span> <span class="fu">max</span>(<span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(walkingdat<span class="sc">$</span>age, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47 72</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     patid           group                time            sex           
 Min.   :  1.00   Length:132         Min.   : 1.435   Length:132        
 1st Qu.: 35.75   Class :character   1st Qu.: 2.169   Class :character  
 Median : 69.50   Mode  :character   Median : 2.428   Mode  :character  
 Mean   : 68.82                      Mean   : 2.866                     
 3rd Qu.:102.25                      3rd Qu.: 2.944                     
 Max.   :136.00                      Max.   :17.641                     
                                                                        
      age          department   
 Min.   :47.00   Min.   :1.000  
 1st Qu.:54.00   1st Qu.:2.000  
 Median :57.00   Median :3.000  
 Mean   :57.69   Mean   :2.583  
 3rd Qu.:60.50   3rd Qu.:3.000  
 Max.   :72.00   Max.   :4.000  
 NA's   :1                      </code></pre>
</div>
</div>
<p><em>Are the oldest and youngest patient male or female?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>(age<span class="sc">==</span><span class="dv">47</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 6
  patid group    time sex     age department
  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;
1   128 control  2.87 F        47          1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>(age<span class="sc">==</span><span class="dv">72</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  patid group    time sex     age department
  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;
1    20 control  5.42 M        72          2
2    62 control 12.2  M        72          2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>walkingdat[<span class="fu">which.max</span>(walkingdat<span class="sc">$</span>age), <span class="st">"sex"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  sex  
  &lt;chr&gt;
1 M    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>walkingdat[<span class="fu">which.min</span>(walkingdat<span class="sc">$</span>age), <span class="st">"sex"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  sex  
  &lt;chr&gt;
1 F    </code></pre>
</div>
</div>
</section>
<section id="cross-tabulation" class="level3">
<h3 class="anchored" data-anchor-id="cross-tabulation">Cross-tabulation</h3>
<p><em>How many Male and Female patient are there?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>( sex <span class="sc">==</span><span class="st">'F'</span> ) <span class="sc">|&gt;</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    35</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>( sex <span class="sc">==</span><span class="st">'M'</span> ) <span class="sc">|&gt;</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    97</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(walkingdat<span class="sc">$</span>sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 F  M 
35 97 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">group_by</span>(sex) <span class="sc">|&gt;</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
# Groups:   sex [2]
  sex       n
  &lt;chr&gt; &lt;int&gt;
1 F        35
2 M        97</code></pre>
</div>
</div>
<p><em>Is the sex ratio balanced between treatment groups?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>( group <span class="sc">==</span><span class="st">'treat'</span>, sex <span class="sc">==</span><span class="st">'M'</span> ) <span class="sc">|&gt;</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    49</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>( group <span class="sc">==</span><span class="st">'treat'</span>, sex <span class="sc">==</span><span class="st">'F'</span> ) <span class="sc">|&gt;</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    17</code></pre>
</div>
</div>
<p><em>How many women are there of age under 50? How many men are there of age under 50?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">50</span> , sex <span class="sc">==</span><span class="st">'F'</span> ) <span class="sc">|&gt;</span>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1     4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>(age <span class="sc">&lt;</span> <span class="dv">50</span> , sex <span class="sc">==</span><span class="st">'M'</span> ) <span class="sc">|&gt;</span>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1     2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(walkingdat<span class="sc">$</span>sex, walkingdat<span class="sc">$</span>age<span class="sc">&lt;</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
    FALSE TRUE
  F    31    4
  M    94    2</code></pre>
</div>
</div>
</section>
<section id="descriptive-statistics-using-a-subset-of-the-data" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics-using-a-subset-of-the-data">Descriptive statistics using a subset of the data</h3>
<p><em>What is the average walking speed for men between 60 and 70 years of age?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>(age <span class="sc">&gt;</span><span class="dv">59</span>, age <span class="sc">&lt;</span><span class="dv">71</span>,  sex <span class="sc">==</span><span class="st">'M'</span> )  <span class="sc">|&gt;</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time) <span class="sc">|&gt;</span> <span class="fu">pull</span>() <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.129875</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="sc">|&gt;</span> <span class="fu">filter</span>( age <span class="sc">&gt;</span><span class="dv">59</span>, age <span class="sc">&lt;</span><span class="dv">71</span>,  sex <span class="sc">==</span><span class="st">'M'</span> ) <span class="sc">|&gt;</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `mean(time)`
         &lt;dbl&gt;
1         3.13</code></pre>
</div>
</div>
</section>
<section id="deriving-new-variables" class="level3">
<h3 class="anchored" data-anchor-id="deriving-new-variables">Deriving new variables</h3>
<p><em>Create a new column that will have the speed of walking, that is 1/time.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="ot">&lt;-</span> walkingdat <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">speed=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">as.numeric</span>(time))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Create a new column that will have the time rounded to the nearest 10th of a second.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>walkingdat <span class="ot">&lt;-</span> walkingdat <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">rounded=</span><span class="fu">round</span>(<span class="fu">as.numeric</span>(time), <span class="at">digits =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="graphing" class="level3">
<h3 class="anchored" data-anchor-id="graphing">Graphing</h3>
<p><em>Consider what kind of graph you might make to illustrate the difference in walking speed between treatment groups, and try to make it using ggplot.</em></p>
<p><em>Make a scatter plot of time vs age</em> <em>Make the colour of each point reflect the treatment group</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>walkingdat) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>age,<span class="at">y=</span>time,<span class="at">colour=</span>group) <span class="sc">+</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Make a box plot of time by sex, with a different coloured box per sex</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>walkingdat) <span class="sc">+</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>sex,<span class="at">y=</span>time,<span class="at">fill=</span>sex) <span class="sc">+</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Label the axes appropriately</em></p>
<p>ggplot(data=walkingdat) + aes(x=sex,y=time,fill=sex) + geom_boxplot() + labs(x=“Sex”, y=“Time to complete task (s)”)</p>
<p><em>Try a violin plot instead of a boxplot (with geom_violin). Which do you prefer?</em> <em>Make any other adjustments you think are informative!</em></p>
</section>
<section id="hypothesis-testing" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis testing</h3>
<p><em>What is the difference in task completion time between control patients and treated patients?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( time <span class="sc">~</span> group , <span class="at">data=</span>walkingdat) <span class="sc">|&gt;</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    3.12      0.228     13.7  6.23e-27
2 grouptreat    -0.512     0.323     -1.58 1.15e- 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( time <span class="sc">~</span> group , <span class="at">data=</span>walkingdat) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time ~ group, data = walkingdat)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6273 -0.7324 -0.4007  0.0606 15.0313 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.1213     0.2283  13.675   &lt;2e-16 ***
grouptreat   -0.5116     0.3228  -1.585    0.115    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.854 on 130 degrees of freedom
Multiple R-squared:  0.01895,   Adjusted R-squared:  0.01141 
F-statistic: 2.512 on 1 and 130 DF,  p-value: 0.1154</code></pre>
</div>
</div>
<p><em>Is this difference statistically significant?</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>( time <span class="sc">~</span> group , <span class="at">data=</span>walkingdat) <span class="sc">|&gt;</span> <span class="fu">anova</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: time
           Df Sum Sq Mean Sq F value Pr(&gt;F)
group       1   8.64  8.6364  2.5116 0.1154
Residuals 130 447.03  3.4387               </code></pre>
</div>
</div>
<p><em>Use t-test <code>t.test()</code> and Mann-Whitney tests <code>wilcox.test()</code> to examine the differences between the groups.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>( time <span class="sc">~</span> group , <span class="at">data=</span>walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  time by group
t = 1.5848, df = 126.66, p-value = 0.1155
alternative hypothesis: true difference in means between group control and group treat is not equal to 0
95 percent confidence interval:
 -0.1272116  1.1503631
sample estimates:
mean in group control   mean in group treat 
             3.121303              2.609727 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>( time <span class="sc">~</span> group , <span class="at">data=</span>walkingdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum test with continuity correction

data:  time by group
W = 3054, p-value = 6.761e-05
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<p><em>. Consider the assumptions underlying the t-test, and whether they are met in this dataset</em></p>
<p>The t-test and the linear model assume that the outcome variable is normally distributed within groups, which is not the case here. So the results from these is probably wrong.</p>
<p>The Mann-Whitney test (Wilcox test) does not make this assumption, and is more robust in this case.</p>
<p><em>Do you believe that treatment affects walking speed?</em></p>
<p><em>Try the t-test or linear model using the speed variable that you created instead of the time variable that is in the dataset.</em></p>
</section>
<section id="diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="diagnostics">Diagnostics</h3>
<p><em>Estimate a linear model (with <code>lm</code>) to estimate/test the effect of treatment on task completion time.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>walkingdat , time <span class="sc">~</span> group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Use <code>summary</code> to get the model coefficients and p-values</em> <em>Use <code>broom::tidy</code> to get the model coefficients and p-values</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = time ~ group, data = walkingdat)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.6273 -0.7324 -0.4007  0.0606 15.0313 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.1213     0.2283  13.675   &lt;2e-16 ***
grouptreat   -0.5116     0.3228  -1.585    0.115    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.854 on 130 degrees of freedom
Multiple R-squared:  0.01895,   Adjusted R-squared:  0.01141 
F-statistic: 2.512 on 1 and 130 DF,  p-value: 0.1154</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>mod1 <span class="sc">|&gt;</span> broom<span class="sc">::</span><span class="fu">tidy</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    3.12      0.228     13.7  6.23e-27
2 grouptreat    -0.512     0.323     -1.58 1.15e- 1</code></pre>
</div>
</div>
<p><em>Compare the model results to the equivalent t-test</em> <em>Extend the model to include the effects of age and sex as potential covariates.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>walkingdat , time <span class="sc">~</span> group <span class="sc">+</span> age <span class="sc">+</span> sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><em>Use <code>plot()</code> to explore the model diagnostics</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="do">## You could plot model 1 or model 2.</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-28-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-28-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-28-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Use <code>performance::check_model</code> to explore the model diagnostics</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Not enough model terms in the conditional part of the model to check for
  multicollinearity.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><em>Now estimate a new model to compare the task completion speed between groups.</em> <em>Get the model coefficients and p-values</em> <em>Check the model diagnostics using <code>plot</code> or <code>performance::check_model</code></em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>walkingdat<span class="sc">$</span>speed <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>walkingdat<span class="sc">$</span>time</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>walkingdat , speed <span class="sc">~</span> group <span class="sc">+</span> age <span class="sc">+</span> sex)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="day2MSc_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<pre><code>a. Why are the result from this model different?  How do you interpret the results?
a. Can you get the confidence intervals for the treatment effect (use the help for `broom::tidy`)
a. Use `model_summary` package to make a pretty model summary table</code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>modelsummary<span class="sc">::</span><span class="fu">modelsummary</span>(mod3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: center;">0.607</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.105)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">grouptreat</td>
<td style="text-align: center;">0.071</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.018)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: center;">−0.004</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: center;">(0.002)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: center;">−0.010</td>
</tr>
<tr class="even">
<td style="text-align: left; box-shadow: 0px 1.5px;"></td>
<td style="text-align: center; box-shadow: 0px 1.5px;">(0.022)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: center;">131</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: center;">0.142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: center;">0.122</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIC</td>
<td style="text-align: center;">−215.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIC</td>
<td style="text-align: center;">−200.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Log.Lik.</td>
<td style="text-align: center;">112.511</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: center;">7.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">RMSE</td>
<td style="text-align: center;">0.10</td>
</tr>
</tbody>
</table>


</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="do">## I didn't do very well!</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>modelsummary<span class="sc">::</span><span class="fu">modelsummary</span>(mod3 , </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">estimate=</span><span class="st">"{estimate} [{conf.low}, {conf.high}] {stars}"</span>, </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">coef_rename =</span> <span class="fu">c</span>(<span class="st">'(Intercept)'</span><span class="ot">=</span><span class="st">"Intercept"</span>, </span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'grouptreat'</span><span class="ot">=</span><span class="st">"Treatment"</span>, </span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'age'</span><span class="ot">=</span><span class="st">"Age (per year)"</span>, </span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>                                           <span class="st">'sexM'</span><span class="ot">=</span><span class="st">"Male vs Female"</span>), </span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">statistic=</span><span class="cn">NULL</span>, )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: center;" data-quarto-table-cell-role="th">&nbsp;(1)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Intercept</td>
<td style="text-align: center;">0.607 [0.398, 0.815] ***</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment</td>
<td style="text-align: center;">0.071 [0.035, 0.107] ***</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Age (per year)</td>
<td style="text-align: center;">−0.004 [−0.008, 0.000] *</td>
</tr>
<tr class="even">
<td style="text-align: left; box-shadow: 0px 1.5px;">Male vs Female</td>
<td style="text-align: center; box-shadow: 0px 1.5px;">−0.010 [−0.054, 0.034]</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Num.Obs.</td>
<td style="text-align: center;">131</td>
</tr>
<tr class="even">
<td style="text-align: left;">R2</td>
<td style="text-align: center;">0.142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R2 Adj.</td>
<td style="text-align: center;">0.122</td>
</tr>
<tr class="even">
<td style="text-align: left;">AIC</td>
<td style="text-align: center;">−215.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BIC</td>
<td style="text-align: center;">−200.6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Log.Lik.</td>
<td style="text-align: center;">112.511</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: center;">7.004</td>
</tr>
<tr class="even">
<td style="text-align: left;">RMSE</td>
<td style="text-align: center;">0.10</td>
</tr>
</tbody>
</table>


</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>