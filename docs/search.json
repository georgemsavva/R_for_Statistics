[
  {
    "objectID": "flipbook.html#section",
    "href": "flipbook.html#section",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)"
  },
  {
    "objectID": "flipbook.html#section-1",
    "href": "flipbook.html#section-1",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")"
  },
  {
    "objectID": "flipbook.html#section-2",
    "href": "flipbook.html#section-2",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)"
  },
  {
    "objectID": "flipbook.html#section-3",
    "href": "flipbook.html#section-3",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)"
  },
  {
    "objectID": "flipbook.html#section-4",
    "href": "flipbook.html#section-4",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA"
  },
  {
    "objectID": "flipbook.html#section-5",
    "href": "flipbook.html#section-5",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA"
  },
  {
    "objectID": "flipbook.html#section-6",
    "href": "flipbook.html#section-6",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-7",
    "href": "flipbook.html#section-7",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-8",
    "href": "flipbook.html#section-8",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata)\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-9",
    "href": "flipbook.html#section-9",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group)\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-10",
    "href": "flipbook.html#section-10",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time)\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-11",
    "href": "flipbook.html#section-11",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA)\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-12",
    "href": "flipbook.html#section-12",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10()\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-13",
    "href": "flipbook.html#section-13",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10() +\n  labs(x=\"Treatment Group\")\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-14",
    "href": "flipbook.html#section-14",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10() +\n  labs(x=\"Treatment Group\") +\n  labs(y=\"Time (seconds)\")\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-15",
    "href": "flipbook.html#section-15",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10() +\n  labs(x=\"Treatment Group\") +\n  labs(y=\"Time (seconds)\") +\n  facet_wrap(~sex)\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-16",
    "href": "flipbook.html#section-16",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10() +\n  labs(x=\"Treatment Group\") +\n  labs(y=\"Time (seconds)\") +\n  facet_wrap(~sex) +\n  theme_bw()\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-17",
    "href": "flipbook.html#section-17",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10() +\n  labs(x=\"Treatment Group\") +\n  labs(y=\"Time (seconds)\") +\n  facet_wrap(~sex) +\n  theme_bw() +\n  coord_flip()\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-18",
    "href": "flipbook.html#section-18",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10() +\n  labs(x=\"Treatment Group\") +\n  labs(y=\"Time (seconds)\") +\n  facet_wrap(~sex) +\n  theme_bw() +\n  coord_flip() +\n  ggtitle(\"The relationship between walking\n  speed and treatment group, stratified by sex\")\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "flipbook.html#section-19",
    "href": "flipbook.html#section-19",
    "title": "Basic ggplot for scientific graphing",
    "section": "",
    "text": "library(readxl)\nwalkingdata &lt;- read_excel(path=\"walkingspeed.xlsx\",\n                          sheet=\"fixed\")\nwalkingdata$department &lt;- factor(walkingdata$department)\nwalkingdata$time &lt;- as.numeric(walkingdata$time)\nwalkingdata$time[walkingdata$time&gt;100] &lt;- NA\nwalkingdata$time[walkingdata$time&lt;1] &lt;- NA\n\nhead(walkingdata)\n\nlibrary(ggplot2)\n\nggplot(walkingdata) +\n  aes(x=group) +\n  aes(y=time) +\n\n  geom_boxplot(outlier.shape = NA, fill=NA) +\n  scale_y_log10() +\n  labs(x=\"Treatment Group\") +\n  labs(y=\"Time (seconds)\") +\n  facet_wrap(~sex) +\n  theme_bw() +\n  coord_flip() +\n  ggtitle(\"The relationship between walking\n  speed and treatment group, stratified by sex\")\n\n\n\n\n# A tibble: 6 × 6\n  patid group    time sex     age department\n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;fct&gt;     \n1     1 treat    1.90 M        53 3         \n2     2 control  3.54 M        61 3         \n3     3 treat    2.93 M        65 1         \n4     4 control  1.82 M        48 2         \n5     5 treat    2.20 M        62 2         \n6     6 control  3.04 M        62 4"
  },
  {
    "objectID": "hi.html",
    "href": "hi.html",
    "title": "Untitled",
    "section": "",
    "text": "Hi!"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R and RStudio for Statistics",
    "section": "",
    "text": "This site hosts my course notes, presentations and data files accompanying my courses on R and RStudio.\n\nNBI/JIC MSc Introduction to R\n\nDay 1\nDay 2\nDay 2 (MSc version)\nDay 3\n\nStatistics notes\n\nDon’t dichotomise your data\n\nNotes on using R\n\nTidyverse, data.table and others for making descriptive tables\nUsing packages, functions and pipes\nUsing ggplot2\n\n\nOlder stuff\n\nJIC MSc Workshop (2021/2022)\n\nTutorial"
  },
  {
    "objectID": "praise.html",
    "href": "praise.html",
    "title": "Packages and Pipes",
    "section": "",
    "text": "R is mainly for statistical computing but there are add-on packages to do many other things. You are likely to need to use add-on packages for reading Excel files, data manipulation, running specific analyses, creating nice reports etc.\nIn this tutorial we will get used to using R packages, objects, functions, pipes and how to use the R help system by making ascii animals say nice things to us."
  },
  {
    "objectID": "praise.html#ok-thats-enough-fun.",
    "href": "praise.html#ok-thats-enough-fun.",
    "title": "Packages and Pipes",
    "section": "5.1 OK that’s enough fun.",
    "text": "5.1 OK that’s enough fun.\nOK now back to the real work."
  },
  {
    "objectID": "workshopscript.html",
    "href": "workshopscript.html",
    "title": "JIC MSc Workshop: Analysis Walkthrough",
    "section": "",
    "text": "Introduction\nThis page supports a short workshop in R and RStudio for Statistics. It is not intended as a comprehensive tutorial but as a vehicle for demonstrating and discussing some aspects of a typical analysis using R, with signposting in the lecture notes for further self-directed learning.\nA simple dataset is introduced along with some research questions and I demonstrate a typical process of loading, visualising, cleaning, analysing and reporting the analysis. The workshop will very briefly introduce:\n\nthe RStudio interface\nsources of help\nusing projects and scripts\nbasics of the R language\nloading data from excel\ntidy data\nthe tidyverse and data.table systems for data wrangling\nmerging and appending datasets\nrunning a R function with named arguments\nthe formula interface\nhow to estimate a linear models\nggplot\n\nSupporting material (presentation slides, dataset) is linked.\nA more detailed R tutorial is also available on this site.\n\n\nBackground to the dataset\nWe have an Excel spreadsheet with data corresponding to a rehabilitation intervention for stroke patients.\nHospital patients were recruited from five hospital departments and were randomised to either standard care or an experimental treatment. The time they took to complete a walking speed task was recorded as the outcome. A lower time corresponds to a better outcome.\nThe dataset is here walkingspeed.xlsx: A R script including only the R command needed for the analysis is here: workshopscript.R:\nWe will answer the following questions:\n\nWhat is the mean and standard deviation of walking speed in each treatment group?\nDoes the treatment improve walking speed?\nIs the treatment effect different between men and women?\n\nOur workflow is typical of most staistical analyses:\n\nLoad data\nWrangle\nDescribe\nVisualise\nClean and recode\nTest and model\nReport\n\n\n\nSet up\nWe will need to install the libraries below if we don’t already have them. We should also start a new project in the project directory, and download the data and the code if necessary.\n\nlibrary(ggplot2)\n\nWarning: package 'ggplot2' was built under R version 4.2.3\n\nlibrary(dplyr)\n\nWarning: package 'dplyr' was built under R version 4.2.3\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(data.table)\n\nWarning: package 'data.table' was built under R version 4.2.2\n\n\n\nAttaching package: 'data.table'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\nlibrary(readxl)\n\nWarning: package 'readxl' was built under R version 4.2.2\n\n\n\n\nLoad data\nWe should inspect the data in Excel. Note there are three sheets that we need to combine to do our analysis.\nReview the “tidy data” powerpoint presentation here: day2_tidydata.pptx.\n\ntreated &lt;- read_excel(path=\"walkingspeed.xlsx\", \n                      sheet = \"treated\",\n                      range = \"A1:B68\")\n\nNotes:\n\nThe library readxl for reading Excel sheets. There are alternatives but I find this works well.\nMultiline function call\nNamed arguments\nAssigning the outcome to the variable\nHelp file, how did we know how this function worked.\n\nWe need to load all three sheets as separate data frames.\n\ncontrol &lt;- read_excel(path=\"walkingspeed.xlsx\", \n                      sheet = \"control\",\n                      range = \"A1:B70\")\n\nmetadata &lt;- read_excel(path=\"walkingspeed.xlsx\", \n                      sheet = \"meta\",\n                      range = \"A1:D139\")\n\n\n\nExplore data\nR includes several functions to inspect data\n\nclass(treated)\n\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n\nstr(treated)\n\ntibble [67 × 2] (S3: tbl_df/tbl/data.frame)\n $ patid: num [1:67] 1 3 5 7 9 11 13 15 17 19 ...\n $ time : chr [1:67] \"1.8975120000000001\" \"2.927432\" \"2.2042579999999998\" \"2.1441910000000002\" ...\n\nsummary(treated)\n\n     patid         time          \n Min.   :  1   Length:67         \n 1st Qu.: 34   Class :character  \n Median : 67   Mode  :character  \n Mean   : 67                     \n 3rd Qu.:100                     \n Max.   :133                     \n\nhead(treated)\n\n# A tibble: 6 × 2\n  patid time              \n  &lt;dbl&gt; &lt;chr&gt;             \n1     1 1.8975120000000001\n2     3 2.927432          \n3     5 2.2042579999999998\n4     7 2.1441910000000002\n5     9 1.7203250000000001\n6    11 2.1476410000000001\n\n# View(treated)\nstr(control)\n\ntibble [69 × 2] (S3: tbl_df/tbl/data.frame)\n $ patid   : num [1:69] 2 4 6 8 10 12 14 16 18 20 ...\n $ walktime: num [1:69] 3.54 1.82 3.04 2.47 2.48 ...\n\n\nNotes:\n\nData can be numeric, character strings, (factors or logical)\nDo we know what each of these types is for?\n\n\n\nAccess elements from the dataframe\n\ncontrol$walktime\n\n [1]   3.537158   1.819787   3.038065   2.469580   2.483921   2.440482\n [7]   2.779616   3.739146   1.956132   5.415308   3.067604 185.362000\n[13]   2.690378   0.015400   2.716427   1.952741   2.707647   5.056214\n[19]   3.319593   1.493927   2.654815   2.856972   2.401613   1.714169\n[25]   3.183433   2.897221  10.590513   2.572139   2.380559   3.528461\n[31]  12.168967   2.274398   2.631071   2.524958   2.191847   3.943916\n[37]   3.390101   5.146895   2.426002   3.340182   2.392610   2.375177\n[43]   2.210679   3.344224   2.233431   2.749903   3.361010   2.803598\n[49]   4.499523   3.642821   2.225054   2.318357   2.241562   2.498969\n[55]   2.378422   2.370767   2.169139   2.373494   2.959015   3.881843\n[61]   2.296210   3.075860   5.033359   2.870730   3.980520   2.290122\n[67]   1.843314   2.083927   2.778637\n\ncontrol$walktime[1]\n\n[1] 3.537158\n\ncontrol$walktime[1:10]\n\n [1] 3.537158 1.819787 3.038065 2.469580 2.483921 2.440482 2.779616 3.739146\n [9] 1.956132 5.415308\n\nmean(control$walktime)\n\n[1] 5.712487\n\nmean(control$walktime[1:5])\n\n[1] 2.669702\n\nlog(control$walktime)\n\n [1]  1.2633236  0.5987195  1.1112208  0.9040481  0.9098384  0.8921956\n [7]  1.0223128  1.3188572  0.6709691  1.6892298  1.1208968  5.2223107\n[13]  0.9896817 -4.1733878  0.9993174  0.6692340  0.9960800  1.6206180\n[19]  1.1998422  0.4014082  0.9763750  1.0497623  0.8761406  0.5389284\n[25]  1.1579602  1.0637520  2.3599586  0.9447378  0.8673353  1.2608618\n[31]  2.4988890  0.8217154  0.9673910  0.9262244  0.7847446  1.3721741\n[37]  1.2208597  1.6383936  0.8862446  1.2060253  0.8723848  0.8650720\n[43]  0.7932997  1.2072347  0.8035390  1.0115656  1.2122415  1.0309036\n[49]  1.5039714  1.2927584  0.7997812  0.8408587  0.8071729  0.9158782\n[55]  0.8664372  0.8632135  0.7743303  0.8643631  1.0848564  1.3563100\n[61]  0.8312599  1.1235845  1.6160876  1.0545664  1.3814125  0.8286051\n[67]  0.6115650  0.7342541  1.0219605\n\nlog(control$walktime[1:5])\n\n[1] 1.2633236 0.5987195 1.1112208 0.9040481 0.9098384\n\n\n\n\nWrangle\nFor analysis we will need all the data into one data frame. We need to append (row bind) the treatment and control results, then merge (join) the meta data.\n\n# Remind ourselves of the structure of the dataset\nstr(treated)\n\ntibble [67 × 2] (S3: tbl_df/tbl/data.frame)\n $ patid: num [1:67] 1 3 5 7 9 11 13 15 17 19 ...\n $ time : chr [1:67] \"1.8975120000000001\" \"2.927432\" \"2.2042579999999998\" \"2.1441910000000002\" ...\n\nstr(control)\n\ntibble [69 × 2] (S3: tbl_df/tbl/data.frame)\n $ patid   : num [1:69] 2 4 6 8 10 12 14 16 18 20 ...\n $ walktime: num [1:69] 3.54 1.82 3.04 2.47 2.48 ...\n\n\nWe need to make sure the vectors we are merging have the same type and name!\nThere are a lot of ways to do the same thing. Here I am illustrating the ‘base’ R way, the ‘tidyverse’ way and the ‘data.table’ way to convert a new numeric variable from a character variable.\n\n# Base R\ntreated$walktime &lt;- as.numeric(treated$time)\n\nWarning: NAs introduced by coercion\n\n# data.table\nsetDT(treated)\ntreated[ , walktime := as.numeric(time)  ]\n\nWarning in eval(jsub, SDenv, parent.frame()): NAs introduced by coercion\n\n# tidyverse\ntreated &lt;- treated %&gt;% mutate(walktime = as.numeric(time))\n\nWarning: There was 1 warning in `mutate()`.\nℹ In argument: `walktime = as.numeric(time)`.\nCaused by warning:\n! NAs introduced by coercion\n\n\nNow we can append the rows and merge them with the metadata. Again there is a tidyverse function for this, and a data.table function for this.\n\n# data.table\ncombined &lt;- rbind(treated, control, fill=TRUE)\ncombined &lt;- rbind(treated=treated, \n                  control=control, \n                  fill=TRUE, idcol=\"group\")\n# tidyverse\ncombined &lt;- bind_rows(treated, control)\ncombined &lt;- bind_rows(treated = treated, \n                      control = control, \n                      .id = \"group\")\n\nstr(metadata)\n\ntibble [138 × 4] (S3: tbl_df/tbl/data.frame)\n $ patient   : num [1:138] 1 2 3 4 5 6 7 8 9 10 ...\n $ sex       : chr [1:138] \"M\" \"M\" \"M\" \"M\" ...\n $ age       : num [1:138] 53 61 65 48 62 62 57 57 57 55 ...\n $ department: num [1:138] 3 3 1 2 2 4 2 4 3 2 ...\n\nstr(combined)\n\nClasses 'data.table' and 'data.frame':  136 obs. of  4 variables:\n $ group   : chr  \"treated\" \"treated\" \"treated\" \"treated\" ...\n $ patid   : num  1 3 5 7 9 11 13 15 17 19 ...\n $ time    : chr  \"1.8975120000000001\" \"2.927432\" \"2.2042579999999998\" \"2.1441910000000002\" ...\n $ walktime: num  1.9 2.93 2.2 2.14 1.72 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n\nwalkingdata &lt;- merge(combined, metadata, \n                by.x = \"patid\", by.y = \"patient\")\n\nhead(walkingdata)\n\n   patid   group               time walktime sex age department\n1:     1 treated 1.8975120000000001 1.897512   M  53          3\n2:     2 control               &lt;NA&gt; 3.537158   M  61          3\n3:     3 treated           2.927432 2.927432   M  65          1\n4:     4 control               &lt;NA&gt; 1.819787   M  48          2\n5:     5 treated 2.2042579999999998 2.204258   M  62          2\n6:     6 control               &lt;NA&gt; 3.038065   M  62          4\n\nstr(walkingdata)\n\nClasses 'data.table' and 'data.frame':  136 obs. of  7 variables:\n $ patid     : num  1 2 3 4 5 6 7 8 9 10 ...\n $ group     : chr  \"treated\" \"control\" \"treated\" \"control\" ...\n $ time      : chr  \"1.8975120000000001\" NA \"2.927432\" NA ...\n $ walktime  : num  1.9 3.54 2.93 1.82 2.2 ...\n $ sex       : chr  \"M\" \"M\" \"M\" \"M\" ...\n $ age       : num  53 61 65 48 62 62 57 57 57 55 ...\n $ department: num  3 3 1 2 2 4 2 4 3 2 ...\n - attr(*, \".internal.selfref\")=&lt;externalptr&gt; \n - attr(*, \"sorted\")= chr \"patid\"\n\nsummary(walkingdata)\n\n     patid           group               time              walktime       \n Min.   :  1.00   Length:136         Length:136         Min.   :  0.0154  \n 1st Qu.: 34.75   Class :character   Class :character   1st Qu.:  2.1688  \n Median : 68.50   Mode  :character   Mode  :character   Median :  2.4287  \n Mean   : 68.52                                         Mean   :  4.1956  \n 3rd Qu.:102.25                                         3rd Qu.:  2.9491  \n Max.   :138.00                                         Max.   :185.3620  \n                                                        NA's   :1         \n     sex                 age          department   \n Length:136         Min.   :45.00   Min.   :1.000  \n Class :character   1st Qu.:54.00   1st Qu.:2.000  \n Mode  :character   Median :57.00   Median :3.000  \n                    Mean   :57.55   Mean   :2.596  \n                    3rd Qu.:60.25   3rd Qu.:3.250  \n                    Max.   :72.00   Max.   :4.000  \n                                                   \n\n\n\n\nDescribe\nOur first task was to describe the mean and standard deviation of walking time by group. There is no simple way to do this with base R. Possible tidyverse and data.table approaches are shown below.\n\n# Tidyverse\nwalkingdata %&gt;% \n  filter(!is.na(walktime)) %&gt;% \n  group_by(group) %&gt;% \n  summarise(Mean=mean(walktime), SD=sd(walktime))\n\n# A tibble: 2 × 3\n  group    Mean    SD\n  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;\n1 control  5.71 22.0 \n2 treated  2.61  2.00\n\n# data.table\nwalkingdata[!is.na(walktime) ,  \n            .(Mean=mean(walktime), SD=sd(walktime)),\n            group]\n\n     group     Mean        SD\n1: treated 2.609674  1.999246\n2: control 5.712487 22.011155\n\n\n\n\nVisualise\nBase R graphics are difficult to work with. ggplot2 provides an excellent system for graphing scientific data using R. See the associated slides and flipbook.\n\n# A very bad graph\nplot(walkingdata$age , walkingdata$walktime)\n\n\n\n# A better graph\nggplot(walkingdata) + \n  aes(x=age, y=walktime) + \n  geom_point()\n\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n\n\n\n\n# Adorn the graph\nggplot(walkingdata) + \n  aes(x=age, y=walktime) + \n  geom_point() + \n  labs(x=\"Age (years)\", y=\"Time (seconds)\") + \n  scale_y_log10() + \n  facet_wrap(~sex) +\n  theme_bw()\n\nWarning: Removed 1 rows containing missing values (`geom_point()`).\n\n\n\n\nggplot(walkingdata) + \n  aes(x=group, y=walktime) + \n  geom_boxplot() + \n  labs(x=\"Treatment group\", y=\"Time (seconds)\") + \n  scale_y_log10() + \n  facet_wrap(~sex) +\n  theme_bw()\n\nWarning: Removed 1 rows containing non-finite values (`stat_boxplot()`).\n\n\n\n\n\n\n\nClean data\nOur graphics suggest that there are some data points that are probably technical failures. We should remove these.\n\n# base\nwalkingdata$walktime[ walkingdata$walktime &gt; 100 ] &lt;- NA\nwalkingdata$walktime[ walkingdata$walktime &lt; 0.1 ] &lt;- NA\n# data.table\nwalkingdata[ walktime&gt;100 , walktime := NA]\nwalkingdata[ walktime&lt;0.1 , walktime := NA]\n\n\n\nSimple tests\nNow we can conduct a simple statistical test of the walking speed across groups. Note the ‘formula’ interface:\n\nt.test( data = walkingdata , walktime ~ group)\n\n\n    Welch Two Sample t-test\n\ndata:  walktime by group\nt = 1.5788, df = 126.69, p-value = 0.1169\nalternative hypothesis: true difference in means between group control and group treated is not equal to 0\n95 percent confidence interval:\n -0.1283567  1.1413738\nsample estimates:\nmean in group control mean in group treated \n             3.116183              2.609674 \n\nttest1 &lt;- t.test( data = walkingdata , walktime ~ group)\nttest1$p.value\n\n[1] 0.1168802\n\n\nWhat does this suggest about the treatment effectiveness?\n\n\nModel\nThis test ignores much of what we know about these participants, and may not be suitable. A linear model is a better paradiagm for statistical analysis. It allows us to build more complex analyses, and easily test our assumptions.\n\nlm1 &lt;- lm( data = walkingdata , walktime ~ group)\nsummary(lm1)\n\n\nCall:\nlm(formula = walktime ~ group, data = walkingdata)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.6223 -0.7297 -0.3963  0.0604 15.0317 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)    3.1162     0.2257  13.806   &lt;2e-16 ***\ngrouptreated  -0.5065     0.3204  -1.581    0.116    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.848 on 131 degrees of freedom\n  (3 observations deleted due to missingness)\nMultiple R-squared:  0.01872,   Adjusted R-squared:  0.01123 \nF-statistic: 2.499 on 1 and 131 DF,  p-value: 0.1163\n\nconfint(lm1)\n\n                 2.5 %    97.5 %\n(Intercept)   2.669671 3.5626939\ngrouptreated -1.140358 0.1273411\n\n\n\n\nDiagnose\nThe diagnostics suggest something is wrong. We can transform the data so that the assumptions of the model are met.\n\nplot(lm1)\n\n\n\n\n\n\n\n\n\n\n\n\nwalkingdata[ , speed := 1/walktime]\n\nlm2 &lt;- lm( data = walkingdata , log(walktime) ~ group)\nlm3 &lt;- lm( data = walkingdata , 1/walktime ~ group)\nplot(lm2)\n\n\n\n\n\n\n\n\n\n\n\n\nplot(lm3)\n\n\n\n\n\n\n\n\n\n\n\n\nsummary(lm3)\n\n\nCall:\nlm(formula = 1/walktime ~ group, data = walkingdata)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.38121 -0.06170  0.00132  0.06453  0.30257 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)   0.36681    0.01287  28.500  &lt; 2e-16 ***\ngrouptreated  0.07108    0.01827   3.891 0.000158 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1053 on 131 degrees of freedom\n  (3 observations deleted due to missingness)\nMultiple R-squared:  0.1036,    Adjusted R-squared:  0.09674 \nF-statistic: 15.14 on 1 and 131 DF,  p-value: 0.0001583\n\ngtsummary::tbl_regression(lm3)\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    group\n\n\n\n        control\n—\n—\n\n        treated\n0.07\n0.03, 0.11\n&lt;0.001\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\n\nIs the interpretation different now?\n\n\nAugment model\nWe can develop the model by adding terms for age and department. We should always include these because they explain variance in the outcome measure.\n\nlm4 &lt;- lm( data = walkingdata , 1/walktime ~ group + age + sex + department)\ngtsummary::tbl_regression(lm4)\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    group\n\n\n\n        control\n—\n—\n\n        treated\n0.07\n0.04, 0.11\n&lt;0.001\n    age\n0.00\n-0.01, 0.00\n0.029\n    sex\n\n\n\n        F\n—\n—\n\n        M\n-0.01\n-0.05, 0.03\n0.6\n    department\n0.02\n0.00, 0.03\n0.060\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\nlm5 &lt;- lm( data = walkingdata , 1/walktime ~ group + age + sex + factor(department))\ngtsummary::tbl_regression(lm5)\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    group\n\n\n\n        control\n—\n—\n\n        treated\n0.07\n0.03, 0.11\n&lt;0.001\n    age\n0.00\n-0.01, 0.00\n0.028\n    sex\n\n\n\n        F\n—\n—\n\n        M\n-0.01\n-0.05, 0.04\n0.7\n    factor(department)\n\n\n\n        1\n—\n—\n\n        2\n-0.01\n-0.06, 0.04\n0.7\n        3\n0.04\n-0.01, 0.09\n0.10\n        4\n0.03\n-0.02, 0.08\n0.2\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\nanova(lm5 , update(lm5, . ~ . -age))\n\nAnalysis of Variance Table\n\nModel 1: 1/walktime ~ group + age + sex + factor(department)\nModel 2: 1/walktime ~ group + sex + factor(department)\n  Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  \n1    126 1.3190                              \n2    127 1.3709 -1 -0.051897 4.9574 0.02776 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nInteractions\nTo test whether the treatment effect varies by sex we should test the group*sex interaction.\n\nlm6 &lt;- lm( data = walkingdata , 1/walktime ~ group*sex + age +  factor(department))\n\ngtsummary::tbl_regression(lm6)\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    group\n\n\n\n        control\n—\n—\n\n        treated\n0.05\n-0.02, 0.12\n0.14\n    sex\n\n\n\n        F\n—\n—\n\n        M\n-0.02\n-0.08, 0.04\n0.5\n    age\n0.00\n-0.01, 0.00\n0.029\n    factor(department)\n\n\n\n        1\n—\n—\n\n        2\n-0.01\n-0.07, 0.04\n0.6\n        3\n0.04\n-0.01, 0.09\n0.10\n        4\n0.03\n-0.02, 0.08\n0.2\n    group * sex\n\n\n\n        treated * M\n0.03\n-0.05, 0.11\n0.5\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\nanova( lm5 , lm6 )\n\nAnalysis of Variance Table\n\nModel 1: 1/walktime ~ group + age + sex + factor(department)\nModel 2: 1/walktime ~ group * sex + age + factor(department)\n  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)\n1    126 1.3190                           \n2    125 1.3148  1 0.0042764 0.4066 0.5249\n\nlibrary(emmeans)\n\nWarning: package 'emmeans' was built under R version 4.2.3\n\nemmeans(lm6, pairwise ~ group | sex)\n\n$emmeans\nsex = F:\n group   emmean     SE  df lower.CL upper.CL\n control  0.379 0.0246 125    0.330    0.428\n treated  0.430 0.0260 125    0.379    0.482\n\nsex = M:\n group   emmean     SE  df lower.CL upper.CL\n control  0.359 0.0151 125    0.330    0.389\n treated  0.436 0.0150 125    0.407    0.466\n\nResults are averaged over the levels of: department \nConfidence level used: 0.95 \n\n$contrasts\nsex = F:\n contrast          estimate     SE  df t.ratio p.value\n control - treated  -0.0513 0.0346 125  -1.481  0.1411\n\nsex = M:\n contrast          estimate     SE  df t.ratio p.value\n control - treated  -0.0771 0.0211 125  -3.654  0.0004\n\nResults are averaged over the levels of: department \n\ntreatmentestimates &lt;- as.data.frame(confint(emmeans(lm6, pairwise ~ group | sex)$contrast))\n\n\ng1 &lt;- ggplot(treatmentestimates) + aes(x=sex, y=estimate, ymin=lower.CL, ymax=upper.CL) + \n  geom_point() + \n  geom_errorbar(width=0.2) + \n  geom_hline(yintercept = 0) + \n  theme_bw() + \n  labs(x=\"Sex\", y=\"Treatment effect\") \n  \ng1 \n\n\n\ng1 + coord_flip()\n\n\n\n\nWhat does this suggest. Does the treatment work in men and women?"
  },
  {
    "objectID": "dichot.html",
    "href": "dichot.html",
    "title": "Why is ‘grouping’ your samples bad for analysis?",
    "section": "",
    "text": "Summary\nIf we have continuous data then we should keep it continuous in analysis. Grouping samples into (say) ‘high’ vs ‘low’ or ‘recovered’ vs ‘not recovered’ throws away information and makes it more difficult to detect associations. The power of your study is reduced and the sample size needed goes up.\n\n\nMotivation\nSuppose we are interested in the effect of an exposure on an outcome, and we have measured both in a sample. Both our exposure and our outcome are measured as continuous variables, for example we might be interested in the effect of fibre intake on gut microbial diversity.\nThere are a couple of possible approaches to the analysis. First, we could estimate or test for a correlation between the exposure and the outcome.\nAlternatively we could dichotomise the exposure, splitting the samples into a “high fibre” and a “low fibre” group, before comparing the microbial diversity in each group. Or we could dichotomise the outcome into “high diversity” and “low diversity”.\nWhich should we choose? Intuitively we might prefer the dichotomised version for “ease of interpretation”, but how does it affect our ability to detect any association?\n\n\nPackages\nWe’ll need the following R packages for this simulation:\n\nlibrary(pwr)\nlibrary(rmarkdown)\nlibrary(knitr)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(MASS)\nlibrary(data.table)\n\n\n\nDataset\nSuppose our exposure and outcome are both normally distributed with a correlation of 0.5.\nWe can sample 50 points as follows:\n\nset.seed(21)\ndat = data.frame(mvrnorm(n=30, mu=c(10,10), Sigma = matrix(c(1,0.5,0.5,1),nrow=2)))\nnames(dat) &lt;- c(\"Exposure\", \"Outcome\")\n\nggplot(dat, aes(x=Exposure, y=Outcome)) + geom_point() + theme_bw()\n\n\n\n\nHow can we estimate or test this correlation by statistical analysis?\nThe simplest way would be to test\n\ncor.test(dat$Exposure, dat$Outcome)\n\n\n    Pearson's product-moment correlation\n\ndata:  dat$Exposure and dat$Outcome\nt = 3.0861, df = 28, p-value = 0.004535\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.1753575 0.7313294\nsample estimates:\n      cor \n0.5037987 \n\n\nSo in our sample this correlation is clearly detectable (estimated r=0.50, p=0.0045).\n\n\nDichotomising variables\nDichotomising means splitting variables into two groups. In our example we might decide to compare those with a high vs a low exposure. Lets make a variable corresponding to whether the exposure for each participant is above observed median. This will split the data into two groups, and we can describe how the outcome differs between the high and low exposure groups:\n\ndat$HighExposure &lt;- dat$Exposure &gt; median(dat$Exposure)\n(ggplot(dat, aes(Exposure, Outcome, color=HighExposure)) + \n  geom_point() + theme_bw() + \n  scale_color_manual(values=c(\"black\", \"red\")))+\n(ggplot(dat, aes(HighExposure, Outcome)) + \n  geom_boxplot() + geom_point(aes(color=HighExposure)) + theme_bw()+ \n  scale_color_manual(values=c(\"black\", \"red\")))\n\n\n\n\nNow we can use (for example) a t-test to for difference in outcome between “high” and “low” exposure groups:\n\nt.test(data=dat, Outcome ~ HighExposure)\n\n\n    Welch Two Sample t-test\n\ndata:  Outcome by HighExposure\nt = -2.3855, df = 27.985, p-value = 0.02407\nalternative hypothesis: true difference in means between group FALSE and group TRUE is not equal to 0\n95 percent confidence interval:\n -1.5826037 -0.1203041\nsample estimates:\nmean in group FALSE  mean in group TRUE \n           9.723858           10.575312 \n\n\nThe difference is now barely detectable (p=0.024)!\nWe could go further, and dichotomise both the outcome and the exposure.\n\ndat$HighOutcome &lt;- dat$Outcome &gt; median(dat$Outcome)\n(ggplot(dat, aes(Exposure, Outcome, color=HighExposure, shape=HighOutcome)) + \n  geom_point() + theme_bw() + geom_hline(yintercept=median(dat$Outcome),lty=2)+\n  scale_color_manual(values=c(\"black\", \"red\")))+\n(ggplot(dat, aes(HighExposure, as.numeric(HighOutcome))) + \n  geom_bar(stat=\"summary\", fun.y=mean, col=\"black\", aes(fill=HighExposure)) + theme_bw()+\n   labs(y=\"Proportion with high outcome\")+\n  scale_fill_manual(values=c(\"black\", \"red\")))\n\n\n\n\nNow our relationship seems obscured. Our analysis consists of analysing a 2x2 contingency table:\n\ntable(dat$HighExposure, dat$HighOutcome)\n\n       \n        FALSE TRUE\n  FALSE    10    5\n  TRUE      5   10\n\nchisq.test(table(dat$HighExposure, dat$HighOutcome))\n\n\n    Pearson's Chi-squared test with Yates' continuity correction\n\ndata:  table(dat$HighExposure, dat$HighOutcome)\nX-squared = 2.1333, df = 1, p-value = 0.1441\n\n\nThe difference in ‘high outcome’ proportions between exposure groups is not statistically significant! (p=0.14). This shows that it is much more difficult to see the relationship if we throw away the exact values of the data points.\nSo although there is a real relationship between exposure and outcome that we have been able to detect by correlating the values in our sample, it was harder to detect when we dichotomised the exposure, and we could not detect it at all in the grouped data.\n\n\nImplications for power and sample size\nOur single example illustrated that dichotomising data made analysis difficult or impossible by discarding data. But it’s easy to cherry pick examples, how does this work in general?\nWe can quantify the average loss of information by power calculations (repeated simulations), and consider how much our sample size would need to increase to overcome this.\nThe graph below shows the power to detect a correlation of 0.5 as the sample size changes using each of the methods described above.\nIf we analyse the continuous data then we need a sample size of about 28 for a power of 80%. If we dichotomise the exposure only we would need 43 samples, if we dichotomise both and analyse the 2x2 table we would need 69, more than twice the original sample.\n\nsampleSizes &lt;- seq(10,100,5)\n\npowers &lt;- data.table(t(sapply(sampleSizes, function(n){c(\n  sampleSizes=n,\n  continuous=100*pwr.r.test(r=0.5, n = n)$power,\n  dichotone=100*pwr.t.test(d=.8 / 0.91, n = n/2)$power,\n  dichotboth=100*pwr.2p.test(h=ES.h(1/3, 2/3), n = n/2)$power\n  )\n  })))\n\nggplot(melt(powers,id.vars = \"sampleSizes\", variable.name = \"Analysis\", value.name = \"Power\"), \n       aes(sampleSizes, Power, color=Analysis)) + \n  geom_line() + \n  geom_point() + \n  theme_bw() + \n  scale_x_continuous(limits=c(0,100)) + \n  labs(x=\"Sample Size (total)\", y=\"Power (%)\") + \n  scale_color_manual(labels=c(dichotboth=\"Dichotomise both\", \n                              dichotone=\"Dichtomise outcome only\", \n                              continuous=\"Correlate continuous measures\"), \n                     values=c(\"black\", \"red\", \"blue\")) + \n  theme(legend.position = c(0.7,0.3), legend.background = element_rect(linetype = 1, size = .5, colour = \"black\")) + \n  geom_hline(yintercept=80, lty=2)\n\n\n\n\n\n\nConclusion\nGrouping up our continuous variables for analysis throws away information. It makes associations more difficult to detect, and increases the number of samples we need to analyse.\nThere are other harmful consequences to dichotomising data. Sometimes a defense of the practice is that by collapsing quantiative findings into yes/no outcomes makes results easier to interpret, but Stephen Senn makes a good case that this is wrong and can even be misleading.\nSo in general, if the phenomenon you are interested in can be measured continuously then you should do so, and be sure to use all of this quantitative information in the analysis.\n\n\nReferences (todo - tidy this up)\nThis phenomenon has been discussed many times in the statistical literature and in blogs\nhttps://errorstatistics.com/2016/08/02/s-senn-painful-dichotomies-guest-post/ (Senn 2016 - a not identical but related problem with dichtomies)\nhttps://www.ncbi.nlm.nih.gov/pmc/articles/PMC1458573/ (Altman and Royston 2006)\nhttp://www.psychology.sunysb.edu/attachment/measures/content/maccallum_on_dichotomizing.pdf (MacCallum et al 2002)\nhttps://bjo.bmj.com/content/98/6/841 (Cumberland et al 2014)"
  }
]